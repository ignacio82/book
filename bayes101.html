<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Bayes 101 – Business Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./decisions_first.html" rel="next">
<link href="./baseline.html" rel="prev">
<link href="./hex.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0dd2bd5de344125cf763a379ddc3eb04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/social-share-0.1.0/social-share.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/all.css" rel="stylesheet">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" src="https://umami.martinez.fyi/script.js" data-website-id="bc587120-3bd3-4c2d-b463-5eb64dd4e330"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="4&nbsp; Bayes 101 – Business Data Science">
<meta property="og:description" content="">
<meta property="og:image" content="https://book.martinez.fyi/img/bayes.webp">
<meta property="og:site_name" content="Business Data Science">
<meta property="og:image:alt" content="Bayes 101">
<meta name="twitter:title" content="4&nbsp; Bayes 101 – Business Data Science">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://book.martinez.fyi/img/bayes.webp">
<meta name="twitter:image:alt" content="Bayes 101">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="[4]{.chapter-number}&nbsp; [Bayes 101]{.chapter-title}">
<meta name="citation_fulltext_html_url" content="https://book.martinez.fyi">
<meta name="citation_language" content="en">
<meta name="citation_book_title" content="Business Data Science: A guide for data-driven decisions">
<meta name="citation_reference" content="citation_title=Sur les applications de la théorie des probabilités aux experiences agricoles: Essai des principes;,citation_author=Jersey Neyman;,citation_publication_date=1923;,citation_cover_date=1923;,citation_year=1923;,citation_issue=1;,citation_volume=10;,citation_journal_title=Roczniki Nauk Rolniczych;">
<meta name="citation_reference" content="citation_title=Causal inference;,citation_author=Peng Ding;,citation_author=Fan Li;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://projecteuclid.org/journals/statistical-science/volume-33/issue-2/Causal-Inference-A-Missing-Data-Perspective/10.1214/18-STS645.pdf;,citation_issue=2;,citation_volume=33;,citation_journal_title=Statistical Science;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=Estimating causal effects of treatments in randomized and nonrandomized studies.;,citation_author=Donald B Rubin;,citation_publication_date=1974;,citation_cover_date=1974;,citation_year=1974;,citation_fulltext_html_url=http://www.fsb.muohio.edu/lij14/420_paper_Rubin74.pdf;,citation_issue=5;,citation_volume=66;,citation_journal_title=Journal of educational Psychology;,citation_publisher=American Psychological Association;">
<meta name="citation_reference" content="citation_title=Bayesian inference for causal effects: The role of randomization;,citation_author=Donald B Rubin;,citation_publication_date=1978;,citation_cover_date=1978;,citation_year=1978;,citation_fulltext_html_url=https://www.jstor.org/stable/2958688;,citation_journal_title=The Annals of statistics;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=The lure of incredible certitude;,citation_author=Charles F Manski;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://www.nber.org/system/files/working_papers/w24905/w24905.pdf;,citation_issue=2;,citation_volume=36;,citation_journal_title=Economics &amp;amp;amp; Philosophy;,citation_publisher=Cambridge University Press;">
<meta name="citation_reference" content="citation_title=The ASA statement on p-values: Context, process, and purpose;,citation_author=Ronald L Wasserstein;,citation_author=Nicole A Lazar;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://www.tandfonline.com/doi/pdf/10.1080/00031305.2016.1154108;,citation_volume=70;,citation_journal_title=The American Statistician;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=What works for whom? A bayesian approach to channeling big data streams for public program evaluation;,citation_author=Mariel McKenzie Finucane;,citation_author=Ignacio Martinez;,citation_author=Scott Cody;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://journals.sagepub.com/doi/abs/10.1177/1098214017737173;,citation_issue=1;,citation_volume=39;,citation_journal_title=American Journal of Evaluation;,citation_publisher=SAGE Publications Sage CA: Los Angeles, CA;">
<meta name="citation_reference" content="citation_title=Beyond “treatment versus control”: How bayesian analysis makes factorial experiments feasible in education research;,citation_author=Daniel Kassler;,citation_author=Ira Nichols-Barrer;,citation_author=Mariel Finucane;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://journals.sagepub.com/doi/abs/10.1177/0193841X18818903;,citation_doi=10.1177/0193841X18818903;">
<meta name="citation_reference" content="citation_title=Nudge: The final edition;,citation_author=Richard H Thaler;,citation_author=Cass R Sunstein;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;">
<meta name="citation_reference" content="citation_title=Nudge: Improving decisions about health, wealth, and happiness;,citation_author=Richard H Thaler;,citation_author=Cass R Sunstein;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;">
<meta name="citation_reference" content="citation_title=Speaking on data’s behalf: What researchers say and how audiences choose;,citation_author=Jesse J Chandler;,citation_author=Ignacio Martinez;,citation_author=Mariel M Finucane;,citation_author=Jeffrey G Terziev;,citation_author=Alexandra M Resch;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_issue=4;,citation_volume=44;,citation_journal_title=Evaluation Review;,citation_publisher=SAGE Publications Sage CA: Los Angeles, CA;">
<meta name="citation_reference" content="citation_title=The null ritual;,citation_author=Gerd Gigerenzer;,citation_author=Stefan Krauss;,citation_author=Oliver Vitouch;,citation_publication_date=2004;,citation_cover_date=2004;,citation_year=2004;,citation_journal_title=The Sage handbook of quantitative methodology for the social sciences;,citation_publisher=Sage Thousand Oaks, CA;">
<meta name="citation_reference" content="citation_title=Robust misinterpretation of confidence intervals;,citation_author=Rink Hoekstra;,citation_author=Richard D Morey;,citation_author=Jeffrey N Rouder;,citation_author=Eric-Jan Wagenmakers;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://ejwagenmakers.com/inpress/HoekstraEtAlPBR.pdf;,citation_doi=10.3758/s13423-013-0572-3;,citation_volume=21;,citation_journal_title=Psychonomic bulletin &amp;amp;amp; review;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Applied causal inference powered by ML and AI;,citation_author=Victor Chernozhukov;,citation_author=Christian Hansen;,citation_author=Nathan Kallus;,citation_author=Martin Spindler;,citation_author=Vasilis Syrgkanis;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://causalml-book.org/assets/chapters/CausalML_chap_2.pdf;,citation_issue=1;,citation_volume=12;">
<meta name="citation_reference" content="citation_title=What works clearinghouse baseline equivalence standard;,citation_author=undefined WWC;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://ies.ed.gov/ncee/wwc/Docs/ReferenceResources/WWC-Baseline-Brief-v6_508.pdf;,citation_technical_report_institution=U.S. Department of Education, Institute of Education Sciences, National Center for Education Evaluation; Regional Assistance;">
<meta name="citation_reference" content="citation_title=Using Rapid-Cycle Evaluation to Improve Program Design and Delivery;,citation_abstract=This chapter discusses rapid-cycle evaluation (RCE) approaches to inform decisions related to program design and to support ongoing program improvement. As the name suggests, RCEs involve quick systematic tests to facilitate learning around programmatic elements. They can be used to diagnose challenges, identify facilitators to implementation and take-up, and test potential solutions. RCEs can be useful at early stages of implementation or program design to help identify operational choices that can maximize chances of a program’s success, as well as during program implementation if a program does not appear to be achieving the desired results. RCE approaches can also be used to test short-term program effectiveness, when taking a program to scale, or when seeking to adapt a successful implementation effort in a different context. This chapter describes the steps involved in implementing RCE and provides several instances of using RCE for program design and improvement.;,citation_author=Emilie Bagby;,citation_author=Anu Rangarajan;,citation_publication_date=2023-12;,citation_cover_date=2023-12;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1093/oxfordhb/9780190059668.013.7;,citation_doi=10.1093/oxfordhb/9780190059668.013.7;,citation_isbn=9780190059668;">
<meta name="citation_reference" content="citation_title=Bayesian causal inference: A critical review;,citation_author=Fan Li;,citation_author=Peng Ding;,citation_author=Fabrizia Mealli;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=2247;,citation_doi=10.1098/rsta.2022.0153;,citation_volume=381;,citation_journal_title=Philosophical Transactions of the Royal Society A;,citation_publisher=The Royal Society;">
<meta name="citation_reference" content="citation_title=The most dangerous equation;,citation_author=Howard Wainer;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_issue=3;,citation_volume=95;,citation_journal_title=American Scientist;">
<meta name="citation_reference" content="citation_title=Inferring causal impact using bayesian structural time-series models;,citation_author=Kay H Brodersen;,citation_author=Fabian Gallusser;,citation_author=Jim Koehler;,citation_author=Nicolas Remy;,citation_author=Steven L Scott;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_doi=10.1214/14-AOAS788;,citation_volume=9;,citation_journal_title=Annals of Applied Statistics;">
<meta name="citation_reference" content="citation_title=Evaluating the surrogate index as a decision-making tool using 200 a/b tests at netflix;,citation_author=Vickie Zhang;,citation_author=Michael Zhao;,citation_author=Anh Le;,citation_author=Nathan Kallus;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_journal_title=arXiv preprint arXiv:2311.11922;">
<meta name="citation_reference" content="citation_title=Long-term causal inference under persistent confounding via data combination;,citation_author=Guido Imbens;,citation_author=Nathan Kallus;,citation_author=Xiaojie Mao;,citation_author=Yuhao Wang;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_journal_title=arXiv preprint arXiv:2202.07234;">
<meta name="citation_reference" content="citation_title=The surrogate index: Combining short-term proxies to estimate long-term treatment effects more rapidly and precisely;,citation_author=Susan Athey;,citation_author=Raj Chetty;,citation_author=Guido W Imbens;,citation_author=Hyunseung Kang;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_technical_report_institution=National Bureau of Economic Research;">
<meta name="citation_reference" content="citation_title=Semiparametric estimation of long-term treatment effects;,citation_author=Jiafeng Chen;,citation_author=David M Ritzwoller;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=2;,citation_volume=237;,citation_journal_title=Journal of Econometrics;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Bayesian and frequentist inference for synthetic controls;,citation_author=Ignacio Martinez;,citation_author=Jaume Vives-i-Bastida;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2206.01779;">
<meta name="citation_reference" content="citation_title=Synthetic controls in action;,citation_author=Alberto Abadie;,citation_author=Jaume Vives-i-Bastida;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://arxiv.org/abs/2203.06279;">
<meta name="citation_reference" content="citation_title=Comparative politics and the synthetic control method;,citation_author=Alberto Abadie;,citation_author=Alexis Diamond;,citation_author=Jens Hainmueller;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_issue=2;,citation_volume=59;,citation_journal_title=American Journal of Political Science;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Parallel experiments in eight schools;,citation_author=A. Gelman;,citation_author=J. B. Carlin;,citation_author=H. S. Stern;,citation_author=D. B. Dunson;,citation_author=A. Vehtari;,citation_author=D. B. Rubin;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://books.google.com/books?id=ZXL6AQAAQBAJ;,citation_isbn=9781439840955;,citation_inbook_title=Bayesian data analysis, third edition;,citation_series_title=Chapman &amp;amp;amp; hall/CRC texts in statistical science;">
<meta name="citation_reference" content="citation_title=Statistics and causal inference;,citation_author=Paul W Holland;,citation_publication_date=1986;,citation_cover_date=1986;,citation_year=1986;,citation_issue=396;,citation_doi=10.2307/2289064;,citation_volume=81;,citation_journal_title=Journal of the American statistical Association;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Rstanarm: Bayesian applied regression modeling via Stan.;,citation_author=Ben Goodrich;,citation_author=Jonah Gabry;,citation_author=Imad Ali;,citation_author=Sam Brilleman;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://mc-stan.org/rstanarm;">
<meta name="citation_reference" content="citation_title=brms: An R package for Bayesian multilevel models using Stan;,citation_author=Paul-Christian Bürkner;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=1;,citation_doi=10.18637/jss.v080.i01;,citation_volume=80;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Stan: A probabilistic programming language;,citation_abstract=Stan is a probabilistic programming language for specifying statistical models. A Stan program imperatively defines a log probability function over parameters conditioned on specified data and constants. As of version 2.14.0, Stan provides full Bayesian inference for continuous-variable models through Markov chain Monte Carlo methods such as the No-U-Turn sampler, an adaptive form of Hamiltonian Monte Carlo sampling. Penalized maximum likelihood estimates are calculated using optimization methods such as the limited memory Broyden-Fletcher-Goldfarb-Shanno algorithm. Stan is also a platform for computing log densities and their gradients and Hessians, which can be used in alternative algorithms such as variational Bayes, expectation propagation, and marginal inference using approximate integration. To this end, Stan is set up so that the densities, gradients, and Hessians, along with intermediate quantities of the algorithm such as acceptance probabilities, are easily accessible. Stan can be called from the command line using the cmdstan package, through R using the rstan package, and through Python using the pystan package. All three interfaces support sampling and optimization-based inference with diagnostics and posterior analysis. rstan and pystan also provide access to log probabilities, gradients, Hessians, parameter transforms, and specialized plotting.;,citation_author=Bob Carpenter;,citation_author=Andrew Gelman;,citation_author=Matthew D. Hoffman;,citation_author=Daniel Lee;,citation_author=Ben Goodrich;,citation_author=Michael Betancourt;,citation_author=Marcus Brubaker;,citation_author=Jiqiang Guo;,citation_author=Peter Li;,citation_author=Allen Riddell;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://www.jstatsoft.org/index.php/jss/article/view/v076i01;,citation_issue=1;,citation_doi=10.18637/jss.v076.i01;,citation_volume=76;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=The state of applied econometrics: Causality and policy evaluation;,citation_author=Susan Athey;,citation_author=Guido W Imbens;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=2;,citation_volume=31;,citation_journal_title=Journal of Economic perspectives;,citation_publisher=American Economic Association 2014 Broadway, Suite 305, Nashville, TN 37203-2418;">
<meta name="citation_reference" content="citation_title=Using synthetic controls: Feasibility, data requirements, and methodological aspects;,citation_author=Alberto Abadie;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=2;,citation_volume=59;,citation_journal_title=Journal of Economic Literature;,citation_publisher=American Economic Association 2014 Broadway, Suite 305, Nashville, TN 37203-2425;">
<meta name="citation_reference" content="citation_title=Potential outcomes causal model;,citation_author=Scott Cunningham;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://mixtape.scunning.com/04-potential_outcomes;,citation_inbook_title=Causal inference: The mixtape;">
<meta name="citation_reference" content="citation_title=BART: Bayesian additive regression trees;,citation_author=Hugh A. Chipman;,citation_author=Edward I. George;,citation_author=Robert E. McCulloch;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1214/09-AOAS285;,citation_issue=1;,citation_doi=10.1214/09-AOAS285;,citation_volume=4;,citation_journal_title=The Annals of Applied Statistics;,citation_publisher=Institute of Mathematical Statistics;">
<meta name="citation_reference" content="citation_title=Bayesian nonparametric modeling for causal inference;,citation_author=Jennifer L Hill;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=1;,citation_doi=10.1198/jcgs.2010.08162;,citation_volume=20;,citation_journal_title=Journal of Computational and Graphical Statistics;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Causal methods madness: Lessons learned from the 2022 ACIC competition to estimate health policy impacts;,citation_author=Dan RC Thal;,citation_author=Mariel M Finucane;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=3;,citation_doi=110.1353/obs.2023.0023;,citation_volume=9;,citation_journal_title=Observational Studies;,citation_publisher=University of Pennsylvania Press;">
<meta name="citation_reference" content="citation_title=Bayesian regression tree models for causal inference: Regularization, confounding, and heterogeneous effects (with discussion);,citation_author=P Richard Hahn;,citation_author=Jared S Murray;,citation_author=Carlos M Carvalho;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_issue=3;,citation_doi=10.1214/19-BA1195;,citation_volume=15;,citation_journal_title=Bayesian Analysis;,citation_publisher=International Society for Bayesian Analysis;">
<meta name="citation_reference" content="citation_title=LongBet: Heterogeneous treatment effect estimation in panel data;,citation_author=Meijia Wang;,citation_author=Ignacio Martinez;,citation_author=P Richard Hahn;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_doi=arXiv:2406.02530;,citation_journal_title=arXiv preprint arXiv:2406.02530;">
<meta name="citation_reference" content="citation_title=Stochtree: Stochastic tree ensembles (XBART and BART) for supervised learning and causal inference;,citation_author=Drew Herren;,citation_author=Richard Hahn;,citation_author=Jared Murray;,citation_author=Carlos Carvalho;,citation_author=Jingyu He;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://stochastictree.github.io/stochtree-r/;">
<meta name="citation_reference" content="citation_title=Stochastic tree ensembles for estimating heterogeneous effects;,citation_abstract=Determining subgroups that respond especially well (or poorly) to specific interventions (medical or policy) requires new supervised learning methods tailored specifically for causal inference. Bayesian Causal Forest (BCF) is a recent method that has been documented to perform well on data generating processes with strong confounding of the sort that is plausible in many applications. This paper develops a novel algorithm for fitting the BCF model, which is more efficient than the previous Gibbs sampler. The new algorithm can be used to initialize independent chains of the existing Gibbs sampler leading to better posterior exploration and coverage of the associated interval estimates in simulation studies. The new algorithm is compared to related approaches via simulation studies as well as an empirical analysis.;,citation_author=Nikolay Krantsevich;,citation_author=Jingyu He;,citation_author=P. Richard Hahn;,citation_editor=Francisco Ruiz;,citation_editor=Jennifer Dy;,citation_editor=Jan-Willem Meent;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://proceedings.mlr.press/v206/krantsevich23a.html;,citation_volume=206;,citation_conference_title=Proceedings of the 26th international conference on artificial intelligence and statistics;,citation_conference=PMLR;,citation_series_title=Proceedings of machine learning research;">
<meta name="citation_reference" content="citation_title=XBART: Accelerated bayesian additive regression trees;,citation_author=Jingyu He;,citation_author=Saar Yalov;,citation_author=P Richard Hahn;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://proceedings.mlr.press/v89/he19a.html;,citation_conference_title=The 22nd international conference on artificial intelligence and statistics;,citation_conference=PMLR;">
<meta name="citation_reference" content="citation_title=Thinking in bets: Making smarter decisions when you don’t have all the facts;,citation_author=Annie Duke;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://www.google.com/books/edition/Thinking_in_Bets/CI-RDwAAQBAJ;">
<meta name="citation_reference" content="citation_title=MatchIt: Nonparametric preprocessing for parametric causal inference;,citation_author=Daniel E. Ho;,citation_author=Kosuke Imai;,citation_author=Gary King;,citation_author=Elizabeth A. Stuart;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=8;,citation_doi=10.18637/jss.v042.i08;,citation_volume=42;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Matching as nonparametric preprocessing for reducing model dependence in parametric causal inference;,citation_author=Daniel E Ho;,citation_author=Kosuke Imai;,citation_author=Gary King;,citation_author=Elizabeth A Stuart;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_issue=3;,citation_volume=15;,citation_journal_title=Political analysis;,citation_publisher=Cambridge University Press;">
<meta name="citation_reference" content="citation_title=Why propensity scores should not be used for matching;,citation_author=Gary King;,citation_author=Richard Nielsen;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=4;,citation_doi=10.1017/pan.2019.11;,citation_volume=27;,citation_journal_title=Political Analysis;">
<meta name="citation_reference" content="citation_title=Bayesianly Justifiable and Relevant Frequency Calculations for the Applied Statistician;,citation_author=Donald B. Rubin;,citation_publication_date=1984;,citation_cover_date=1984;,citation_year=1984;,citation_fulltext_html_url=https://doi.org/10.1214/aos/1176346785;,citation_issue=4;,citation_doi=10.1214/aos/1176346785;,citation_volume=12;,citation_journal_title=The Annals of Statistics;,citation_publisher=Institute of Mathematical Statistics;">
<meta name="citation_reference" content="citation_title=Bayesian data analysis for newcomers;,citation_author=John K Kruschke;,citation_author=Torrin M Liddell;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_doi=10.3758/s13423-017-1272-1;,citation_volume=25;,citation_journal_title=Psychonomic bulletin &amp;amp;amp; review;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Bayesian data analysis, third edition;,citation_author=A. Gelman;,citation_author=J. B. Carlin;,citation_author=H. S. Stern;,citation_author=D. B. Dunson;,citation_author=A. Vehtari;,citation_author=D. B. Rubin;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=http://www.stat.columbia.edu/~gelman/book/;,citation_isbn=9781439840955;,citation_series_title=Chapman &amp;amp;amp; hall/CRC texts in statistical science;">
<meta name="citation_reference" content="citation_title=Statistical rethinking: A bayesian course with examples in r and stan;,citation_author=R. McElreath;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://books.google.com/books?id=T3FQDwAAQBAJ;,citation_isbn=9781315362618;,citation_series_title=Chapman &amp;amp;amp; hall/CRC texts in statistical science;">
<meta name="citation_reference" content="citation_title=Statistical rethinking: A bayesian course with examples in r and stan;,citation_author=R. McElreath;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://books.google.com/books?id=T3FQDwAAQBAJ;,citation_isbn=9781315362618;,citation_series_title=Chapman &amp;amp;amp;amp; hall/CRC texts in statistical science;">
<meta name="citation_reference" content="citation_title=Shinylive: Run ’shiny’ applications in the browser;,citation_author=Barret Schloerke;,citation_author=Winston Chang;,citation_author=George Stagg;,citation_author=Garrick Aden-Buie;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://posit-dev.github.io/r-shinylive/;">
<meta name="citation_reference" content="citation_title=Distribution theory for glass’s estimator of effect size and related estimators;,citation_author=Larry V Hedges;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_issue=2;,citation_doi=10.3102/10769986006002107;,citation_volume=6;,citation_journal_title=journal of Educational Statistics;,citation_publisher=Sage Publications Sage CA: Thousand Oaks, CA;">
<meta name="citation_reference" content="citation_title=Regression models and life-tables;,citation_author=David R Cox;,citation_publication_date=1972;,citation_cover_date=1972;,citation_year=1972;,citation_fulltext_html_url=https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/j.2517-6161.1972.tb00899.x;,citation_issue=2;,citation_doi=https://doi.org/10.1111/j.2517-6161.1972.tb00899.x;,citation_volume=34;,citation_journal_title=Journal of the Royal Statistical Society: Series B (Methodological);,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Baseline equivalence: What it is and why it is needed;,citation_author=Mary Anne Anderson;,citation_author=Nan Maxwell;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://www.mathematica.org/-/media/publications/pdfs/labor/2021/cncs_baseline-equivalencebrief.pdf;,citation_journal_title=Submitted to AmeriCorps by Mathematica. Chicago, IL, September;">
<meta name="citation_reference" content="citation_title=STA 640 — causal inference unit 6.2: Post-treatment confounding: Principal stratification;,citation_author=Fan Li;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www2.stat.duke.edu/~fl35/teaching/640/Chapter6.2_principal%20stratification.pdf;">
<meta name="citation_reference" content="citation_title=Identification of causal effects using instrumental variables;,citation_author=Joshua D Angrist;,citation_author=Guido W Imbens;,citation_author=Donald B Rubin;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_issue=434;,citation_doi=10.1080/01621459.1996.10476902;,citation_volume=91;,citation_journal_title=Journal of the American statistical Association;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Principal stratification in causal inference;,citation_author=Constantine E Frangakis;,citation_author=Donald B Rubin;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_fulltext_html_url=https://doi.org/10.1111/j.0006-341X.2002.00021.x;,citation_issue=1;,citation_doi=10.1111/j.0006-341X.2002.00021.x;,citation_volume=58;,citation_journal_title=Biometrics;,citation_publisher=Oxford University Press;">
<meta name="citation_reference" content="citation_title=Instrumental variables: An econometrician’s perspective;,citation_author=Guido Imbens;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_doi=10.3386/w19983;,citation_technical_report_institution=National Bureau of Economic Research;">
<meta name="citation_reference" content="citation_title=Bayesian inference for causal effects in randomized experiments with noncompliance;,citation_author=Guido W. Imbens;,citation_author=Donald B. Rubin;,citation_publication_date=1997;,citation_cover_date=1997;,citation_year=1997;,citation_fulltext_html_url=http://www.jstor.org/stable/2242722;,citation_issue=1;,citation_issn=00905364;,citation_volume=25;,citation_journal_title=The Annals of Statistics;,citation_publisher=Institute of Mathematical Statistics;">
<meta name="citation_reference" content="citation_title=PStrata: An r package for principal stratification;,citation_author=Bo Liu;,citation_author=Fan Li;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://arxiv.org/abs/2304.02740;">
<meta name="citation_reference" content="citation_title=Principal stratification–uses and limitations;,citation_author=Tyler J VanderWeele;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=1;,citation_doi=10.2202/1557-4679.1329;,citation_volume=7;,citation_journal_title=The international journal of biostatistics;,citation_publisher=De Gruyter;">
<meta name="citation_reference" content="citation_title=Finite mixtures and zero-inflated models;,citation_author=Stan Development Team;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://mc-stan.org/docs/stan-users-guide/finite-mixtures.html#zero-inflated.section;">
<meta name="citation_reference" content="citation_title=A guide to modeling outcomes that have lots of zeros with bayesian hurdle lognormal and hurdle gaussian regression models;,citation_author=Andrew Heiss;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.andrewheiss.com/blog/2022/05/09/hurdle-lognormal-gaussian-brms/;">
<meta name="citation_reference" content="citation_title=Trial registration at ClinicalTrials. Gov between may and october 2005;,citation_author=Deborah A Zarin;,citation_author=Tony Tse;,citation_author=Nicholas C Ide;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_issue=26;,citation_volume=353;,citation_journal_title=New England Journal of Medicine;,citation_publisher=Mass Medical Soc;">
<meta name="citation_reference" content="citation_title=PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies;,citation_author=Nianbo Dong;,citation_author=Rebecca Maynard;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://www.ipr.northwestern.edu/documents/required-reading/2018/dong--maynard-2013.pdf;,citation_issue=1;,citation_volume=6;,citation_journal_title=Journal of Research on Educational Effectiveness;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=The core analytics of randomized experiments for social research;,citation_author=Howard S Bloom;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_fulltext_html_url=https://files.eric.ed.gov/fulltext/ED493363.pdf;,citation_journal_title=The SAGE handbook of social research methods;,citation_publisher=Sage Los Angeles;">
<meta name="citation_reference" content="citation_title=Beyond power calculations: Assessing type s (sign) and type m (magnitude) errors;,citation_author=Andrew Gelman;,citation_author=John Carlin;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://journals.sagepub.com/doi/pdf/10.1177/1745691614551642?trk=public_post_comment-text;,citation_issue=6;,citation_volume=9;,citation_journal_title=Perspectives on psychological science;,citation_publisher=Sage Publications Sage CA: Los Angeles, CA;">
<meta name="citation_reference" content="citation_title=Test &amp;amp;amp; roll: Profit-maximizing a/b tests;,citation_author=Elea McDonnell Feit;,citation_author=Ron Berman;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://ui.adsabs.harvard.edu/abs/2018arXiv181100457M/abstract;,citation_journal_title=arXiv e-prints;">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Introduction</a></li><li class="breadcrumb-item"><a href="./bayes101.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes 101</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./hex.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./hex.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Business Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ignacio82/book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What Does it Mean to Be Data-Driven?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potential_outcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Potential Outcomes Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./baseline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Equivalence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes101.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes 101</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decisions_first.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Decisions First Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rce.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rapid-Cycle Evaluation for Program Improvement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./surrogates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Surrogates</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./rct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Gold Standard</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rct_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Power of Randomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Bayesian Adaptive Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bayesian Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Randomized Encouragement Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Importance of Coordination</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strength.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Study Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./other_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Non Experimental Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Matching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causalimpact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Bayesian Structural Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bsynth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Bayesian Synthetic Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Meta-Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beyond_normality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Beyond Normality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hurdle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Hurdle Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stochastictrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic Trees</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Bayesian Additive Regression Trees (BART)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bcf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Bayesian Causal Forest (BCF)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longbet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">LongBet: Heterogeneous Treatment Effects in Panel Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causalPropensity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Causal Propensity Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-essence-of-bayesian-thinking" id="toc-the-essence-of-bayesian-thinking" class="nav-link active" data-scroll-target="#the-essence-of-bayesian-thinking"><span class="header-section-number">4.1</span> The Essence of Bayesian Thinking</a></li>
  <li><a href="#bayes-rule-the-heart-of-bayesian-statistics" id="toc-bayes-rule-the-heart-of-bayesian-statistics" class="nav-link" data-scroll-target="#bayes-rule-the-heart-of-bayesian-statistics"><span class="header-section-number">4.2</span> Bayes’ Rule: The Heart of Bayesian Statistics</a></li>
  <li><a href="#the-case-of-the-declining-user-engagement" id="toc-the-case-of-the-declining-user-engagement" class="nav-link" data-scroll-target="#the-case-of-the-declining-user-engagement"><span class="header-section-number">4.3</span> The Case of the Declining User Engagement</a></li>
  <li><a href="#communicating-uncertainty-credible-intervals-vs.-confidence-intervals" id="toc-communicating-uncertainty-credible-intervals-vs.-confidence-intervals" class="nav-link" data-scroll-target="#communicating-uncertainty-credible-intervals-vs.-confidence-intervals"><span class="header-section-number">4.4</span> Communicating Uncertainty: Credible Intervals vs.&nbsp;Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#analogy" id="toc-analogy" class="nav-link" data-scroll-target="#analogy">Analogy</a></li>
  <li><a href="#beyond-intervals-posterior-probabilities-for-tailored-insight" id="toc-beyond-intervals-posterior-probabilities-for-tailored-insight" class="nav-link" data-scroll-target="#beyond-intervals-posterior-probabilities-for-tailored-insight">Beyond Intervals: Posterior Probabilities for Tailored Insight</a></li>
  </ul></li>
  <li><a href="#the-case-of-karl-bromans-socks-a-bayesian-adventure-in-tiny-data" id="toc-the-case-of-karl-bromans-socks-a-bayesian-adventure-in-tiny-data" class="nav-link" data-scroll-target="#the-case-of-karl-bromans-socks-a-bayesian-adventure-in-tiny-data"><span class="header-section-number">4.5</span> The Case of Karl Broman’s Socks: A Bayesian Adventure in Tiny Data</a>
  <ul class="collapse">
  <li><a href="#the-bayesian-approach-to-the-sock-problem" id="toc-the-bayesian-approach-to-the-sock-problem" class="nav-link" data-scroll-target="#the-bayesian-approach-to-the-sock-problem">The Bayesian Approach to the Sock Problem</a></li>
  <li><a href="#visualizing-the-results" id="toc-visualizing-the-results" class="nav-link" data-scroll-target="#visualizing-the-results">Visualizing the Results</a></li>
  <li><a href="#results-and-interpretation" id="toc-results-and-interpretation" class="nav-link" data-scroll-target="#results-and-interpretation">Results and Interpretation</a></li>
  <li><a href="#a-note-on-priors" id="toc-a-note-on-priors" class="nav-link" data-scroll-target="#a-note-on-priors">A Note on Priors</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4.6</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ignacio82/book/edit/master/bayes101.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Introduction</a></li><li class="breadcrumb-item"><a href="./bayes101.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes 101</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayes 101</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="img/bayes.webp" align="right" height="280" alt="Bayes 101"></p>
<p>In the bustling marketplace of ideas that is modern data science, Bayesian statistics stands out as a powerful and intuitive approach to understanding uncertainty and making decisions. For business data scientists, it offers a flexible framework that naturally incorporates prior knowledge, updates beliefs based on new evidence, and quantifies uncertainty in a way that’s both mathematically rigorous and intuitively appealing.</p>
<p>Now, let’s set some expectations. To truly thrive as a business data scientist, you’ll need more than a passing familiarity with statistics. Think of it this way: an analyst knows how to use a calculator, while a data scientist knows how that calculator works—and can even build one from scratch to tackle the specific problem at hand. Let me be clear: this chapter isn’t a course in calculator construction. We won’t delve into the nuts and bolts of how it’s built, or even all the inner workings. Instead, our aim is to convince you that this particular calculator is worth learning more about. We want to spark your curiosity, to show you why this tool deserves a prime spot in your data science toolbox.</p>
<p>In this chapter, we’ll explore the basics of Bayesian statistics, delve into Bayes’ rule, and examine why this paradigm is particularly well-suited for business applications.</p>
<section id="the-essence-of-bayesian-thinking" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-essence-of-bayesian-thinking"><span class="header-section-number">4.1</span> The Essence of Bayesian Thinking</h2>
<p>At its core, Bayesian statistics is about updating our beliefs in light of new evidence. This process mirrors how we often think about problems in business: we start with some prior knowledge or assumptions, gather data, and then update our understanding based on what we’ve learned.</p>
<p>As <span class="citation" data-cites="kruschke2018bayesian">Kruschke and Liddell (<a href="references.html#ref-kruschke2018bayesian" role="doc-biblioref">2018</a>)</span> eloquently put it, “The main idea of Bayesian analysis is simple and intuitive. There are some data to be explained, and we have a set of candidate explanations. Before knowing the new data, the candidate explanations have some prior credibilities of being the best explanation. Then, when given the new data, we shift credibility toward the candidate explanations that better account for the data, and we shift credibility away from the candidate explanations that do not account well for the data.”</p>
<p>This perspective highlights a fundamental principle of Bayesian analysis: it’s a process of reallocating credibility across possibilities. In a business context, these “possibilities” might be different strategies, market scenarios, or parameter values in a model. As we gather more data, we adjust our beliefs about which possibilities are more or less likely to be true.</p>
<p>The Bayesian approach contrasts with the more traditional frequentist statistics in a fundamental way. While frequentists treat parameters as fixed (but unknown) quantities and data as random, Bayesians view parameters as random variables and data as fixed once observed. This shift in perspective leads to more intuitive interpretations of statistical results and allows for the incorporation of prior knowledge into our analyses.</p>
</section>
<section id="bayes-rule-the-heart-of-bayesian-statistics" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="bayes-rule-the-heart-of-bayesian-statistics"><span class="header-section-number">4.2</span> Bayes’ Rule: The Heart of Bayesian Statistics</h2>
<p>The cornerstone of Bayesian statistics is Bayes’ rule, named after the Reverend Thomas Bayes. This elegant formula shows us how to update probabilities when we receive new information. In its simplest form, Bayes’ rule is expressed as:</p>
<p><span class="math display">\[
P(A|B) = \frac{P(B|A)P(A)}{P(B)}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(P(A|B)\)</span> is the posterior probability of A given B</li>
<li><span class="math inline">\(P(B|A)\)</span> is the likelihood of B given A</li>
<li><span class="math inline">\(P(A)\)</span> is the prior probability of A</li>
<li><span class="math inline">\(P(B)\)</span> is the marginal likelihood of B</li>
</ul>
<p>In the context of parameter estimation, which is often our goal in business data science, we can rewrite Bayes’ rule as:</p>
<p><span class="math display">\[
P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\theta\)</span> represents our parameter(s) of interest</li>
<li><span class="math inline">\(D\)</span> represents our observed data</li>
<li><span class="math inline">\(P(\theta|D)\)</span> is the posterior distribution of our parameter given the data</li>
<li><span class="math inline">\(P(D|\theta)\)</span> is the likelihood of the data given the parameter</li>
<li><span class="math inline">\(P(\theta)\)</span> is our prior distribution for the parameter</li>
<li><span class="math inline">\(P(D)\)</span> is the marginal likelihood of the data</li>
</ul>
<p>This formulation clearly illustrates the process of reallocating credibility. We start with our prior beliefs about the parameters <span class="math inline">\(P(\theta)\)</span>, consider how likely the data are given those parameters <span class="math inline">\(P(D|\theta)\)</span>, and end up with an updated (posterior) belief about the parameters <span class="math inline">\(P(\theta|D)\)</span>.</p>
</section>
<section id="the-case-of-the-declining-user-engagement" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="the-case-of-the-declining-user-engagement"><span class="header-section-number">4.3</span> The Case of the Declining User Engagement</h2>
<p>Even if you haven’t formally studied Bayesian statistics, your brain is already wired to think like a Bayesian. To illustrate how this intuitive approach can be applied to real-world business problems, let’s consider a scenario that data scientists in the tech sector frequently encounter: investigating a sudden decline in user engagement and its potential impact on revenue.</p>
<p>Imagine you’re a business data scientist at a high-growth tech company that offers a subscription-based productivity app. You’ve noticed a concerning trend: daily active users (DAU) have dropped by 15% over the past month, and this is starting to affect revenue. Your task is to identify the most likely cause of this engagement drop and recommend actions to reverse the trend.</p>
<p>Let’s say we have four main hypotheses for the cause of the declining engagement:</p>
<ol type="1">
<li>A recent feature update (Feature)</li>
<li>Increased competition in the market (Competition)</li>
<li>Seasonal variation (Seasonality)</li>
<li>Changes in marketing spend (Marketing)</li>
</ol>
<p>Before diving into the data, you have some prior beliefs about the likelihood of each cause, based on your experience and industry knowledge:</p>
<ul>
<li>Feature: 35% (feature updates can sometimes negatively impact user experience)</li>
<li>Competition: 25% (the market is becoming more saturated)</li>
<li>Seasonality: 20% (there’s often a summer slowdown in productivity app usage)</li>
<li>Marketing: 20% (marketing budgets have been fluctuating)</li>
</ul>
<p>This is your prior distribution. Now, as you investigate, you gather evidence:</p>
<ol type="1">
<li>User feedback shows mixed reactions to the recent feature update, with some users reporting confusion about the new interface.</li>
<li>Market research indicates that while a major competitor launched a new product, it hasn’t gained significant market share yet.</li>
<li>Historical data shows a similar dip in engagement during the same period last year, though not as pronounced.</li>
<li>Marketing spend has remained consistent over the past quarter.</li>
</ol>
<p>As you collect this evidence, you update your beliefs about the likelihood of each cause. This is where Bayesian reasoning comes into play, allowing you to reallocate credibility based on the new information.</p>
<p>After considering the evidence, you might update your beliefs as follows:</p>
<ul>
<li>Feature: 60% (user feedback suggests this is a significant factor)</li>
<li>Competition: 8% (less likely given the market research)</li>
<li>Seasonality: 30% (historical data supports this as a contributing factor)</li>
<li>Marketing: 2% (unlikely given consistent spend)</li>
</ul>
<p>This is your posterior distribution. You’ve reallocated credibility based on the evidence, increasing your belief that the feature update and seasonality are the primary causes of the engagement drop.</p>
</section>
<section id="communicating-uncertainty-credible-intervals-vs.-confidence-intervals" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="communicating-uncertainty-credible-intervals-vs.-confidence-intervals"><span class="header-section-number">4.4</span> Communicating Uncertainty: Credible Intervals vs.&nbsp;Confidence Intervals</h2>
<p>In Bayesian statistics, we often express our uncertainty about an estimated parameter using <strong>credible intervals.</strong> A 95% credible interval, for example, is a range of values that we believe, with 95% probability, contains the true value of the parameter. This interpretation is quite intuitive and aligns well with how we naturally think about uncertainty.</p>
<p>It’s important to contrast credible intervals with confidence intervals, which are frequently misinterpreted <span class="citation" data-cites="hoekstra2014robust">(<a href="references.html#ref-hoekstra2014robust" role="doc-biblioref">Hoekstra et al. 2014</a>)</span>. While both express uncertainty, their interpretations differ:</p>
<ul>
<li><p>A 95% confidence interval is constructed such that, if we were to repeat the experiment many times, 95% of the intervals we calculate would contain the true parameter value. This interpretation is somewhat less intuitive and focuses on the long-run behavior of the procedure rather than the specific interval at hand.</p></li>
<li><p>A 95% credible interval, on the other hand, directly states that there’s a 95% probability that the true parameter value lies within this particular interval, given the observed data and our prior beliefs.</p></li>
</ul>
<p>In summary:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 34%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Feature</strong></th>
<th style="text-align: center;"><strong>Confidence Interval</strong></th>
<th style="text-align: center;"><strong>Credible Interval</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Philosophy</td>
<td style="text-align: center;">Frequentist</td>
<td style="text-align: center;">Bayesian</td>
</tr>
<tr class="even">
<td style="text-align: center;">Interpretation</td>
<td style="text-align: center;">Repeated sampling</td>
<td style="text-align: center;">Probability of the parameter</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Prior knowledge</td>
<td style="text-align: center;">Not used</td>
<td style="text-align: center;">Can be incorporated</td>
</tr>
<tr class="even">
<td style="text-align: center;">Statement about</td>
<td style="text-align: center;">The interval itself</td>
<td style="text-align: center;">The parameter</td>
</tr>
</tbody>
</table>
<section id="analogy" class="level3">
<h3 class="anchored" data-anchor-id="analogy">Analogy</h3>
<p>Imagine you’re trying to estimate the height of a tree.</p>
<ul>
<li><p><strong>Confidence interval:</strong> You take multiple measurements from different angles and use them to construct an interval. You say, “If I repeated this process many times, 95% of the intervals I create would contain the tree’s true height.”</p></li>
<li><p><strong>Credible interval:</strong> You consider your previous knowledge about trees in the area, combine it with your measurements, and say, “Based on my measurements and what I already know, there’s a 95% probability that the tree’s height is between X and Y meters.” Credible intervals provide a more intuitive and direct interpretation of uncertainty about a parameter. However, they require specifying prior distributions, which can be subjective. Confidence intervals, while less intuitive, are widely used and don’t require prior information.</p></li>
</ul>
</section>
<section id="beyond-intervals-posterior-probabilities-for-tailored-insight" class="level3">
<h3 class="anchored" data-anchor-id="beyond-intervals-posterior-probabilities-for-tailored-insight">Beyond Intervals: Posterior Probabilities for Tailored Insight</h3>
<p>Though credible intervals offer a convenient snapshot of uncertainty, they might not always be the optimal tool to inform decisions. Let’s consider a scenario where we’re assessing whether an intervention’s impact surpasses a specific threshold. This threshold could be zero – indicating whether the intervention has any effect at all – or it could be any other relevant value, depending on the decision at hand.</p>
<p>In the Bayesian framework, we can bypass the limitations of intervals and compute the probability of the impact exceeding our threshold directly from the posterior distribution. We simply determine the proportion of the distribution that lies beyond the threshold. This gives us the posterior probability that the parameter of interest is greater than our chosen value, providing a clear and actionable insight.</p>
<p>It’s worth noting that we might have multiple thresholds relevant to different decisions. For example, we might be interested in the probability that the impact is at least ‘moderately’ large, or the probability that it is ‘substantially’ large. The Bayesian approach allows us to calculate these probabilities directly from the posterior, tailoring our uncertainty quantification to the specific decision context.</p>
</section>
</section>
<section id="the-case-of-karl-bromans-socks-a-bayesian-adventure-in-tiny-data" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="the-case-of-karl-bromans-socks-a-bayesian-adventure-in-tiny-data"><span class="header-section-number">4.5</span> The Case of Karl Broman’s Socks: A Bayesian Adventure in Tiny Data</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/socks.png" class="img-fluid figure-img" style="width:50.0%" alt="[Karl Broman's Socks](https://x.com/kwbroman/status/523221976001679360)"></p>
<figcaption>Karl Broman’s Socks</figcaption>
</figure>
</div>
<p>To illustrate the power of Bayesian thinking, even with limited data, let’s consider an intriguing example from Rasmus Bååth’s Blog, which he calls “Tiny Data, Approximate Bayesian Computation and the Socks of Karl Broman” (see <a href="https://www.sumsar.net/blog/2014/10/tiny-data-and-the-socks-of-karl-broman/">original blog post</a>). The problem is deceptively simple: Given that <a href="https://x.com/kwbroman/status/523221976001679360">Karl Broman has 11 unique socks in his laundry</a>, how many socks does he have in total? This is a perfect example of what Bååth calls “Tiny Data” - a situation where we have very limited information but still need to make an inference. It’s a scenario that business data scientists often face, where decisions need to be made with incomplete information.</p>
<section id="the-bayesian-approach-to-the-sock-problem" class="level3">
<h3 class="anchored" data-anchor-id="the-bayesian-approach-to-the-sock-problem">The Bayesian Approach to the Sock Problem</h3>
<p>Bååth tackles this problem using Approximate Bayesian Computation (ABC), an intuitive albeit computationally intensive method (see <span class="citation" data-cites="rubin1984bayesianly">Rubin (<a href="references.html#ref-rubin1984bayesianly" role="doc-biblioref">1984</a>)</span>).</p>
<p>In this Bayesian adventure, we begin with two crucial pieces of information, encoded as prior probability distributions. The number of socks is a count variable, so we’ll employ a negative binomial data generating process. (We delve into this topic in more detail in <a href="beyond_normality.html#sec-negative-binomial" class="quarto-xref"><span>Section 19.3</span></a>.) For now, let’s follow Bååth’s lead and set (<span class="math inline">\(\mu = 30\)</span>) and (size = 4).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe of possible sock counts</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sock_counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n_socks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probabilities from the negative binomial distribution</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sock_counts<span class="sc">$</span>probability <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(sock_counts<span class="sc">$</span>n_socks, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the histogram</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sock_counts, <span class="fu">aes</span>(<span class="at">x =</span> n_socks, <span class="at">y =</span> probability)) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total Number of Socks"</span>, <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Prior Distribution for Total Number of Socks"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bayes101_files/figure-html/prior_socks-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next, we need to specify our beliefs about the proportion of socks that have a pair. For this, we can use a beta data generating process. To remain consistent with the blog post, we’ll set shape1 = 15 and shape2 = 2. This distribution is skewed towards higher values, suggesting a belief that most socks in a laundry pile are likely to be paired. The parameters indicate an expectation around 0.88, reflecting the common experience that unmatched socks are less frequent.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of proportions from 0 to 1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density values from the beta distribution</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>density_values <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(proportions, <span class="at">shape1 =</span> <span class="dv">15</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the density plot</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">proportion =</span> proportions, <span class="at">density =</span> density_values),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> proportion, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Proportion of Paired Socks"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Prior Distribution for Proportion of Paired Socks"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bayes101_files/figure-html/prior_prop-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These prior distributions encapsulate our initial beliefs before we observe any data. The Bayesian approach elegantly allows us to update these beliefs based on the evidence, leading to more informed posterior distributions.</p>
<p>Now, let’s craft the R code for simulating draws from this data generating process.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable parallel processing with the number of cores available</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of socks picked</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>n_picked <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Improved simulation function</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>simulate_socks <span class="ot">&lt;-</span> <span class="cf">function</span>(n_picked) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate total number of socks from prior</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  n_socks <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate proportion of paired socks from prior</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  prop_pairs <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> <span class="dv">15</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate number of pairs and odd socks</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  n_pairs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">floor</span>(n_socks <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> prop_pairs)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  n_odd <span class="ot">&lt;-</span> n_socks <span class="sc">-</span> n_pairs <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate picking socks</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  socks <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_pairs <span class="sc">+</span> n_odd), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="fu">c</span>(n_pairs, n_odd)))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  picked_socks <span class="ot">&lt;-</span> <span class="fu">sample</span>(socks, <span class="at">size =</span> <span class="fu">min</span>(n_picked, n_socks))</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  sock_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(picked_socks)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique =</span> <span class="fu">sum</span>(sock_counts <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairs =</span> <span class="fu">sum</span>(sock_counts <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_socks =</span> n_socks,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_pairs =</span> n_pairs,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_odd =</span> n_odd,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_pairs =</span> prop_pairs</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simulations</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>sock_sim <span class="ot">&lt;-</span> <span class="fu">future_map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_sims, <span class="sc">~</span><span class="fu">simulate_socks</span>(n_picked),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">123</span>))</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for matching simulations (11 unique socks, 0 pairs)</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>post_samples <span class="ot">&lt;-</span> sock_sim <span class="sc">%&gt;%</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique <span class="sc">==</span> <span class="dv">11</span>, pairs <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This code implements the ABC method, which is a perfect illustration of the “reallocation of credibility across possibilities” that Kruschke and Liddell describe:</p>
<ol type="1">
<li>We define prior distributions for the total number of socks (negative binomial) and the proportion of paired socks (beta). These represent our initial beliefs about the possibilities.</li>
<li>We create a generative model that simulates picking socks from a laundry pile.</li>
<li>We run this simulation many times (100,000 in this case), each time generating a possible scenario.</li>
<li>We keep only those simulations that match our observed data (11 unique socks, 0 pairs). This step is where we reallocate credibility, focusing on the possibilities that are consistent with our observation.</li>
<li>We analyze the results by calculating median values from the retained samples, which represent our updated beliefs.</li>
</ol>
</section>
<section id="visualizing-the-results" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-results">Visualizing the Results</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>prior_data <span class="ot">&lt;-</span> sock_sim <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_socks) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"Prior"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>posterior_data <span class="ot">&lt;-</span> post_samples <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_socks) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"Posterior"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_data, posterior_data)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot prior and posterior distributions</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> n_socks, <span class="at">y =</span> prop, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prior"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"Posterior"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior and Posterior Distributions of Total Socks"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Socks"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Distribution"</span>) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior distribution of pairs and odd socks</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samples, <span class="fu">aes</span>(<span class="at">x =</span> n_pairs, <span class="at">y =</span> n_odd)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Joint Posterior Distribution of Pairs and Odd Socks"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Pairs"</span>, <span class="at">y =</span> <span class="st">"Number of Odd Socks"</span>) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Computation failed in `stat_binhex()`.
Caused by error in `compute_group()`:
! The package "hexbin" is required for `stat_bin_hex()`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bayes101_files/figure-html/viz-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="results-and-interpretation">Results and Interpretation</h3>
<p>After running this model, our best guess (median of the posterior) is that Karl Broman has approximately:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> post_samples <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_socks =</span> <span class="fu">median</span>(n_socks),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_pairs =</span> <span class="fu">median</span>(n_pairs),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_odd =</span> <span class="fu">median</span>(n_odd),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower_socks =</span> <span class="fu">quantile</span>(n_socks, <span class="fl">0.025</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper_socks =</span> <span class="fu">quantile</span>(n_socks, <span class="fl">0.975</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>Total socks: 45 (95% CI: 24 - 86)</li>
<li>Pairs of socks: 19</li>
<li>Odd socks: 6</li>
</ul>
<p>Remarkably, when Karl later revealed the actual numbers, it turned out there were 21 pairs and 3 odd socks, totaling 45 socks. The estimate is surprisingly close, considering we only had one piece of information to work with! The visualizations provide additional insights:</p>
<p>The first plot shows how our beliefs about the total number of socks changed from the prior (green) to the posterior (blue) distribution after incorporating the data. This is a clear visualization of the reallocation of credibility across possibilities. The second plot illustrates the joint posterior distribution of pairs and odd socks, showing the range of plausible combinations given our model and data.</p>
<p>This example beautifully illustrates several key aspects of Bayesian thinking:</p>
<ol type="1">
<li>Incorporation of prior knowledge: The model uses reasonable priors based on general knowledge about sock ownership.</li>
<li>Handling uncertainty: The posterior distribution provides a range of plausible values, not just a point estimate.</li>
<li>Learning from limited data: Even with just one piece of information (11 unique socks), we can make a surprisingly accurate inference.</li>
<li>Flexibility: The ABC approach allows us to work with a complex model that would be difficult to handle with traditional methods.</li>
<li>Reallocation of credibility: We start with a wide range of possibilities and narrow down to those most consistent with our observation.</li>
</ol>
<p>In business contexts, we often face similar situations - limited data combined with domain expertise or prior experience. The sock example, while whimsical, demonstrates how Bayesian methods can be powerful in such real-world scenarios. As we progress through this book, we’ll explore how these principles can be applied to more complex business problems.</p>
<p>As Kruschke and Liddell (2018) point out, one of the key advantages of Bayesian analysis is that “the posterior distribution can be directly examined to see which parameter values are most credible, and what range of parameter values covers the most credible values.” This direct interpretation is particularly valuable in business settings, where we often need to communicate results to non-technical stakeholders.</p>
<p>For instance, in our sock example, we can straightforwardly say that “there’s a 95% probability that the total number of socks is between 24 and 86.” This statement is intuitive and directly addresses the uncertainty in our estimate, which is crucial for informed decision-making. Additionally, we can quantify probabilities for specific scenarios, such as: “The probability that there are at least 15 pairs is 78%.”</p>
<p>Moreover, Bayesian methods naturally handle the “small data” scenarios that are common in business. While big data gets a lot of attention, many important business decisions are made with limited information. The Bayesian framework allows us to start with prior knowledge (perhaps based on industry benchmarks or previous experience), update this with whatever data is available, and still produce meaningful results.</p>
</section>
<section id="a-note-on-priors" class="level3">
<h3 class="anchored" data-anchor-id="a-note-on-priors">A Note on Priors</h3>
<p>It’s important to remember that the less data you have, the more influential your priors become. Transparency about your priors is essential, as is investigating the sensitivity of your findings to different prior choices. However, don’t shy away from using informative priors when justified by data. The interactive dashboard below utilizes {shinylive} (see <span class="citation" data-cites="shinylive">Schloerke et al. (<a href="references.html#ref-shinylive" role="doc-biblioref">2024</a>)</span>) to run these simulations directly in your browser, allowing you to experiment with various priors and observe their impact.</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| viewerHeight: 800
library(shiny)
library(ggplot2)
library(dplyr)
library(furrr)
library(shinybusy)
library(shinydashboard)

# Enable parallel processing with the number of cores available
plan(multisession, workers = availableCores())

# Define the number of socks picked
n_picked &lt;- 11

simulate_socks &lt;- function(n_picked, mu, size, shape1, shape2) {
  # Generate total number of socks from prior
  n_socks &lt;- rnbinom(1, mu = mu, size = size)
  
  # Generate proportion of paired socks from prior
  prop_pairs &lt;- rbeta(1, shape1 = shape1, shape2 = shape2)
  
  # Calculate number of pairs and odd socks
  n_pairs &lt;- round(floor(n_socks / 2) * prop_pairs)
  n_odd &lt;- n_socks - n_pairs * 2
  
  # Simulate picking socks
  socks &lt;- rep(seq_len(n_pairs + n_odd), rep(c(2, 1), c(n_pairs, n_odd)))
  picked_socks &lt;- sample(socks, size = min(n_picked, n_socks))
  sock_counts &lt;- table(picked_socks)
  
  # Return results
  tibble(
    unique = sum(sock_counts == 1),
    pairs = sum(sock_counts == 2),
    n_socks = n_socks,
    n_pairs = n_pairs,
    n_odd = n_odd,
    prop_pairs = prop_pairs
  )
}

ui &lt;- dashboardPage(
  skin = "black",
  dashboardHeader(title = "Karl's Socks"),
  dashboardSidebar(
    numericInput(
      inputId = "seed",
      label = "Random Seed",
      value = 123,
      min = 1,
      step = 1
    ),
    numericInput(
      inputId = "n_sims",
      label = "Number of Simulations",
      value = 10000,
      min = 100,
      step = 100
    ),
    sliderInput(
      inputId = "mu",
      label = "mu",
      min = 15,
      max = 60,
      value = 40,
      step = 1
    ),
    sliderInput(
      inputId = "size",
      label = "Size",
      min = 3,
      max = 10,
      value = 4,
      step = 1
    ),
    sliderInput(
      inputId = "shape1",
      label = "Shape 1",
      min = 2,
      max = 20,
      value = 15,
      step = 1
    ),
    sliderInput(
      inputId = "shape2",
      label = "Shape 2",
      min = 2,
      max = 8,
      value = 2,
      step = 1
    ),
    actionButton("run_sim", "Run Simulation")
  ),
  dashboardBody(
    use_busy_spinner(spin = "fading-circle"),
    fluidRow(
      box(
        title = "Prior Distribution for Total Number of Socks", 
        status = "danger", solidHeader = TRUE,
        collapsible = TRUE,
        plotOutput("prior_socks")
      ),
      
      box(
        title = "Prior Distribution for Proportion of Paired Socks", 
        status = "danger", solidHeader = TRUE,
        collapsible = TRUE,
        plotOutput("prior_prop")
      )
    ),
    
    fluidRow(
      box(
        title = "Prior and Posterior Distributions of Total Socks", 
        status = "danger", solidHeader = TRUE,
        collapsible = TRUE,
        plotOutput("distribution_plot")
      ),
      
      box(
        title = "Joint Posterior Distribution of Pairs and Odd Socks", 
        status = "danger", solidHeader = TRUE,
        collapsible = TRUE,
        plotOutput("joint_plot")
      )
    ),
    
    fluidRow(
      valueBoxOutput("pr_pairs")
    )
  )
)

server &lt;- function(input, output) {
  
  sock_sim &lt;- eventReactive(input$run_sim, {
    show_modal_spinner()  
    on.exit(remove_modal_spinner())
    set.seed(input$seed)
    local_mu &lt;- input$mu
    local_size &lt;- input$size
    local_shape1 &lt;- input$shape1
    local_shape2 &lt;- input$shape2
    future_map_dfr(1:input$n_sims,
                   ~simulate_socks(n_picked = 11,
                                   mu = local_mu,
                                   size = local_size,
                                   shape1 = local_shape1,
                                   shape2 = local_shape2),
                   .options = furrr_options(seed = 123))
  })
  
  # Filter for matching simulations (11 unique socks, 0 pairs)
  post_samples &lt;- reactive({
    sock_sim() %&gt;% 
      filter(unique == 11, pairs == 0)
  })
  
  output$pr_pairs &lt;- renderValueBox({
    req(post_samples())
    valueBox(
      scales::percent(mean(post_samples()$n_pairs &gt; 14)),
      "Pr[# Pairs &gt; 14]", icon = icon("socks"),
      color = "red"
    )
  })
  
  # Prepare data for plotting
  prior_data &lt;- reactive({
    sock_sim() %&gt;%
      count(n_socks) %&gt;%
      mutate(prop = n / sum(n),
             type = "Prior")
  })
  
  posterior_data &lt;- reactive({
    if(nrow(post_samples()) == 0) {
      return(tibble(n_socks = numeric(), prop = numeric(), type = character())) 
    }
    post_samples() %&gt;%
      count(n_socks) %&gt;%
      mutate(prop = n / sum(n),
             type = "Posterior")
  })
  
  output$prior_socks &lt;- renderPlot({
    # Dataframe of possible sock counts
    sock_counts &lt;- data.frame(n_socks = 0:100)
    
    # Calculate probabilities from the negative binomial distribution
    sock_counts$probability &lt;- dnbinom(sock_counts$n_socks,
                                       mu = input$mu,
                                       size = input$size)
    
    # Create the histogram
    ggplot(sock_counts, aes(x = n_socks, y = probability)) +
      geom_col(fill = "skyblue", color = "black")+ 
      scale_y_continuous(labels = scales::percent) +
      theme_minimal() +
      labs(x = "Total Number of Socks", y = "Probability")
  })
  
  output$prior_prop &lt;- renderPlot({
    # Create a sequence of proportions from 0 to 1
    proportions &lt;- seq(0, 1, length.out = 100)
    
    # Calculate density values from the beta distribution
    density_values &lt;- dbeta(proportions, shape1 = input$shape1,
                            shape2 = input$shape2)
    
    # Create the density plot
    ggplot(data.frame(proportion = proportions, density = density_values),
           aes(x = proportion, y = density)) +
      geom_line(color = "darkgreen") +
      theme_minimal() +
      labs(x = "Proportion of Paired Socks", y = "Density")
  })
  
  output$distribution_plot &lt;- renderPlot({
    req(prior_data(), posterior_data())
    plot_data &lt;- bind_rows(prior_data(), posterior_data())
    
    ggplot(plot_data, aes(x = n_socks, y = prop, fill = type)) +
      geom_col(position = "dodge", alpha = 0.7) +
      scale_fill_manual(values = c("Prior" = "lightgreen", "Posterior" = "skyblue")) +
      scale_y_continuous(labels = scales::percent) +
      labs(x = "Number of Socks", y = "Probability", fill = "Distribution") +
      theme_minimal() +
      theme(legend.position = "top")
  })
  
  output$joint_plot &lt;- renderPlot({
    req(post_samples())
    if(nrow(post_samples()) &gt; 0) {
      ggplot(post_samples(), aes(x = n_pairs, y = n_odd)) +
        geom_hex(bins = 30) +
        scale_fill_viridis_c() +
        labs(x = "Number of Pairs", y = "Number of Odd Socks") +
        theme_minimal()
    } else {
      ggplot() + 
        annotate("text", x = 0.5, y = 0.5, label = "No matching simulations found") +
        theme_void()
    }
  })
}

shinyApp(ui, server)
</code></pre>
</section>
</section>
<section id="conclusion" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">4.6</span> Conclusion</h2>
<p>Bayesian statistics offers a powerful and intuitive framework for business data science, aligning closely with how businesses make decisions. By incorporating prior knowledge, we can update our beliefs based on evidence and quantify uncertainty in a natural way. The concept of reallocating credibility across possibilities provides an intuitive way to think about learning from data.</p>
<p>Furthermore, Bayesian methods are particularly well-suited to the “small data” scenarios often encountered in business. While “big data” garners much attention, many crucial business decisions hinge on limited information. The Bayesian framework allows us to begin with prior knowledge, update it with available data, and then communicate our findings in plain language.</p>
<p>In essence, Bayesian statistics provides a flexible and powerful approach for tackling the complex and often uncertain world of business decision-making.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Learn more
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><span class="citation" data-cites="kruschke2018bayesian">Kruschke and Liddell (<a href="references.html#ref-kruschke2018bayesian" role="doc-biblioref">2018</a>)</span> Bayesian data analysis for newcomers.</li>
<li><span class="citation" data-cites="mcelreath2018statistical">McElreath (<a href="references.html#ref-mcelreath2018statistical" role="doc-biblioref">2018</a>)</span> Statistical Rethinking: A Bayesian Course with Examples in R and Stan</li>
<li><span class="citation" data-cites="gelman2013bayesian">Gelman et al. (<a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">2013</a>)</span> Bayesian Data Analysis.</li>
</ul>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-gelman2013bayesian" class="csl-entry" role="listitem">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2013. <em>Bayesian Data Analysis, Third Edition</em>. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis. <a href="http://www.stat.columbia.edu/~gelman/book/">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-hoekstra2014robust" class="csl-entry" role="listitem">
Hoekstra, Rink, Richard D Morey, Jeffrey N Rouder, and Eric-Jan Wagenmakers. 2014. <span>“Robust Misinterpretation of Confidence Intervals.”</span> <em>Psychonomic Bulletin &amp; Review</em> 21: 1157–64. <a href="https://doi.org/10.3758/s13423-013-0572-3">https://doi.org/10.3758/s13423-013-0572-3</a>.
</div>
<div id="ref-kruschke2018bayesian" class="csl-entry" role="listitem">
Kruschke, John K, and Torrin M Liddell. 2018. <span>“Bayesian Data Analysis for Newcomers.”</span> <em>Psychonomic Bulletin &amp; Review</em> 25 (1): 155–77. <a href="https://doi.org/10.3758/s13423-017-1272-1">https://doi.org/10.3758/s13423-017-1272-1</a>.
</div>
<div id="ref-mcelreath2018statistical" class="csl-entry" role="listitem">
McElreath, R. 2018. <em>Statistical Rethinking: A Bayesian Course with Examples in r and Stan</em>. Chapman &amp; Hall/CRC Texts in Statistical Science. CRC Press. <a href="https://books.google.com/books?id=T3FQDwAAQBAJ">https://books.google.com/books?id=T3FQDwAAQBAJ</a>.
</div>
<div id="ref-rubin1984bayesianly" class="csl-entry" role="listitem">
Rubin, Donald B. 1984. <span>“<span class="nocase">Bayesianly Justifiable and Relevant Frequency Calculations for the Applied Statistician</span>.”</span> <em>The Annals of Statistics</em> 12 (4): 1151–72. <a href="https://doi.org/10.1214/aos/1176346785">https://doi.org/10.1214/aos/1176346785</a>.
</div>
<div id="ref-shinylive" class="csl-entry" role="listitem">
Schloerke, Barret, Winston Chang, George Stagg, and Garrick Aden-Buie. 2024. <em>Shinylive: Run ’Shiny’ Applications in the Browser</em>. <a href="https://posit-dev.github.io/r-shinylive/">https://posit-dev.github.io/r-shinylive/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/book\.martinez\.fyi");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="ignacio82/book" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./baseline.html" class="pagination-link" aria-label="Baseline Equivalence">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Baseline Equivalence</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./decisions_first.html" class="pagination-link" aria-label="A Decisions First Framework">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Decisions First Framework</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Bayes 101"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - shinylive</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"img/bayes.webp"</span><span class="ot"> align</span><span class="op">=</span><span class="st">"right"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"280"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"Bayes 101"</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>In the bustling marketplace of ideas that is modern data science, Bayesian</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>statistics stands out as a powerful and intuitive approach to understanding</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>uncertainty and making decisions. For business data scientists, it offers a</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>flexible framework that naturally incorporates prior knowledge, updates beliefs</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>based on new evidence, and quantifies uncertainty in a way that's both</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>mathematically rigorous and intuitively appealing.</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>Now, let's set some expectations. To truly thrive as a business data scientist,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>you'll need more than a passing familiarity with statistics. Think of it this</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>way: an analyst knows how to use a calculator, while a data scientist knows how</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>that calculator works—and can even build one from scratch to tackle the specific</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>problem at hand. Let me be clear: this chapter isn't a course in calculator</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>construction. We won't delve into the nuts and bolts of how it's built, or even</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>all the inner workings. Instead, our aim is to convince you that this particular</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>calculator is worth learning more about. We want to spark your curiosity, to</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>show you why this tool deserves a prime spot in your data science toolbox.</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>In this chapter, we'll explore the basics of Bayesian statistics, delve into</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>Bayes' rule, and examine why this paradigm is particularly well-suited for</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>business applications.</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Essence of Bayesian Thinking</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>At its core, Bayesian statistics is about updating our beliefs in light of new</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>evidence. This process mirrors how we often think about problems in business: we</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>start with some prior knowledge or assumptions, gather data, and then update our</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>understanding based on what we've learned.</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>As @kruschke2018bayesian eloquently put it, "The main idea of Bayesian analysis</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>is simple and intuitive. There are some data to be explained, and we have a set</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>of candidate explanations. Before knowing the new data, the candidate</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>explanations have some prior credibilities of being the best explanation. Then,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>when given the new data, we shift credibility toward the candidate explanations</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>that better account for the data, and we shift credibility away from the</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>candidate explanations that do not account well for the data."</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>This perspective highlights a fundamental principle of Bayesian analysis: it's a</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>process of reallocating credibility across possibilities. In a business context,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>these "possibilities" might be different strategies, market scenarios, or</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>parameter values in a model. As we gather more data, we adjust our beliefs about</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>which possibilities are more or less likely to be true.</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>The Bayesian approach contrasts with the more traditional frequentist statistics</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>in a fundamental way. While frequentists treat parameters as fixed (but unknown)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>quantities and data as random, Bayesians view parameters as random variables and</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>data as fixed once observed. This shift in perspective leads to more intuitive</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>interpretations of statistical results and allows for the incorporation of prior</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>knowledge into our analyses.</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayes' Rule: The Heart of Bayesian Statistics</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>The cornerstone of Bayesian statistics is Bayes' rule, named after the Reverend</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>Thomas Bayes. This elegant formula shows us how to update probabilities when we</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>receive new information. In its simplest form, Bayes' rule is expressed as:</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>P(A|B) = \frac{P(B|A)P(A)}{P(B)}</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(A|B)$ is the posterior probability of A given B</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(B|A)$ is the likelihood of B given A</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(A)$ is the prior probability of A</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(B)$ is the marginal likelihood of B</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>In the context of parameter estimation, which is often our goal in business data</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>science, we can rewrite Bayes' rule as:</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>P(\theta|D) = \frac{P(D|\theta)P(\theta)}{P(D)}</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$\theta$ represents our parameter(s) of interest</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$D$ represents our observed data</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(\theta|D)$ is the posterior distribution of our parameter given the data</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(D|\theta)$ is the likelihood of the data given the parameter</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(\theta)$ is our prior distribution for the parameter</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$P(D)$ is the marginal likelihood of the data</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>This formulation clearly illustrates the process of reallocating credibility. We</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>start with our prior beliefs about the parameters $P(\theta)$, consider how</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>likely the data are given those parameters $P(D|\theta)$, and end up with an</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>updated (posterior) belief about the parameters $P(\theta|D)$.  </span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Case of the Declining User Engagement</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>Even if you haven't formally studied Bayesian statistics, your brain is already</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>wired to think like a Bayesian. To illustrate how this intuitive approach can be</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>applied to real-world business problems, let's consider a scenario that data</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>scientists in the tech sector frequently encounter: investigating a sudden</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>decline in user engagement and its potential impact on revenue.</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>Imagine you're a business data scientist at a high-growth tech company that</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>offers a subscription-based productivity app. You've noticed a concerning trend:</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>daily active users (DAU) have dropped by 15% over the past month, and this is</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>starting to affect revenue. Your task is to identify the most likely cause of</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>this engagement drop and recommend actions to reverse the trend.</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>Let's say we have four main hypotheses for the cause of the declining</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>engagement:</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>A recent feature update (Feature)</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Increased competition in the market (Competition)</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Seasonal variation (Seasonality)</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Changes in marketing spend (Marketing)</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>Before diving into the data, you have some prior beliefs about the likelihood of</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>each cause, based on your experience and industry knowledge:</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Feature: 35% (feature updates can sometimes negatively impact user</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>    experience)</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Competition: 25% (the market is becoming more saturated)</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Seasonality: 20% (there's often a summer slowdown in productivity app usage)</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Marketing: 20% (marketing budgets have been fluctuating)</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>This is your prior distribution. Now, as you investigate, you gather evidence:</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>User feedback shows mixed reactions to the recent feature update, with some</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>    users reporting confusion about the new interface.</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Market research indicates that while a major competitor launched a new</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>    product, it hasn't gained significant market share yet.</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Historical data shows a similar dip in engagement during the same period</span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>    last year, though not as pronounced.</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Marketing spend has remained consistent over the past quarter.</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>As you collect this evidence, you update your beliefs about the likelihood of</span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>each cause. This is where Bayesian reasoning comes into play, allowing you to</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>reallocate credibility based on the new information.</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>After considering the evidence, you might update your beliefs as follows:</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Feature: 60% (user feedback suggests this is a significant factor)</span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Competition: 8% (less likely given the market research)</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Seasonality: 30% (historical data supports this as a contributing factor)</span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Marketing: 2% (unlikely given consistent spend)</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>This is your posterior distribution. You've reallocated credibility based on the</span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>evidence, increasing your belief that the feature update and seasonality are the</span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>primary causes of the engagement drop.</span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Communicating Uncertainty: Credible Intervals vs. Confidence Intervals</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>In Bayesian statistics, we often express our uncertainty about an estimated</span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>parameter using **credible intervals.** A 95% credible interval, for example, is</span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>a range of values that we believe, with 95% probability, contains the true value</span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>of the parameter. This interpretation is quite intuitive and aligns well with</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>how we naturally think about uncertainty.</span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>It's important to contrast credible intervals with confidence intervals, which</span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>are frequently misinterpreted <span class="co">[</span><span class="ot">@hoekstra2014robust</span><span class="co">]</span>. While both express</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>uncertainty, their interpretations differ:</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>A 95% confidence interval is constructed such that, if we were to repeat the</span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>    experiment many times, 95% of the intervals we calculate would contain the</span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>    true parameter value. This interpretation is somewhat less intuitive and</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>    focuses on the long-run behavior of the procedure rather than the specific</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>    interval at hand.</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>A 95% credible interval, on the other hand, directly states that there's</span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>    a 95% probability that the true parameter value lies within this particular</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>    interval, given the observed data and our prior beliefs.</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>In summary:</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>   **Feature**   | **Confidence Interval** |     **Credible Interval**    <span class="pp">|</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a><span class="pp">|:---------------:|:-----------------------:|:----------------------------:|</span></span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Philosophy      <span class="pp">|</span> Frequentist             <span class="pp">|</span> Bayesian                     <span class="pp">|</span></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Interpretation  <span class="pp">|</span> Repeated sampling       <span class="pp">|</span> Probability of the parameter <span class="pp">|</span></span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Prior knowledge <span class="pp">|</span> Not used                <span class="pp">|</span> Can be incorporated          <span class="pp">|</span></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Statement about <span class="pp">|</span> The interval itself     <span class="pp">|</span> The parameter                <span class="pp">|</span></span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analogy</span></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>Imagine you're trying to estimate the height of a tree.</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Confidence interval:** You take multiple measurements from different</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>    angles and use them to construct an interval. You say, "If I repeated this</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>    process many times, 95% of the intervals I create would contain the tree's</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>    true height."</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Credible interval:** You consider your previous knowledge about trees in</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>    the area, combine it with your measurements, and say, "Based on my</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>    measurements and what I already know, there's a 95% probability that the</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>    tree's height is between X and Y meters." Credible intervals provide a more</span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>    intuitive and direct interpretation of uncertainty about a parameter.</span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>    However, they require specifying prior distributions, which can be</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>    subjective. Confidence intervals, while less intuitive, are widely used and</span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>    don't require prior information.</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beyond Intervals: Posterior Probabilities for Tailored Insight</span></span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>Though credible intervals offer a convenient snapshot of uncertainty, they might</span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>not always be the optimal tool to inform decisions. Let's consider a scenario</span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>where we're assessing whether an intervention's impact surpasses a specific</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>threshold. This threshold could be zero – indicating whether the intervention</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>has any effect at all – or it could be any other relevant value, depending on</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>the decision at hand.</span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>In the Bayesian framework, we can bypass the limitations of intervals and</span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>compute the probability of the impact exceeding our threshold directly from the</span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>posterior distribution. We simply determine the proportion of the distribution</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>that lies beyond the threshold. This gives us the posterior probability that the</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>parameter of interest is greater than our chosen value, providing a clear and</span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>actionable insight.</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>It's worth noting that we might have multiple thresholds relevant to different</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>decisions. For example, we might be interested in the probability that the</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>impact is at least 'moderately' large, or the probability that it is</span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>'substantially' large. The Bayesian approach allows us to calculate these</span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>probabilities directly from the posterior, tailoring our uncertainty</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>quantification to the specific decision context.</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Case of Karl Broman's Socks: A Bayesian Adventure in Tiny Data</span></span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a><span class="al">![Karl Broman's Socks](img/socks.png)</span>{fig-alt="<span class="co">[</span><span class="ot">Karl Broman's Socks</span><span class="co">](https://x.com/kwbroman/status/523221976001679360)</span>" fig-align="center" width=50%}</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>To illustrate the power of Bayesian thinking, even with limited data, let's</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>consider an intriguing example from Rasmus Bååth's Blog, which he calls "Tiny</span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>Data, Approximate Bayesian Computation and the Socks of Karl Broman" (see</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>[original blog</span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>post](https://www.sumsar.net/blog/2014/10/tiny-data-and-the-socks-of-karl-broman/)).</span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>The problem is deceptively simple: Given that [Karl Broman has 11 unique socks</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>in his laundry](https://x.com/kwbroman/status/523221976001679360), how many</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>socks does he have in total? This is a perfect example of what Bååth calls "Tiny</span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>Data" - a situation where we have very limited information but still need to</span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>make an inference. It's a scenario that business data scientists often face,</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>where decisions need to be made with incomplete information.</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bayesian Approach to the Sock Problem</span></span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>Bååth tackles this problem using Approximate Bayesian Computation (ABC), an</span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>intuitive albeit computationally intensive method (see @rubin1984bayesianly).</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>In this Bayesian adventure, we begin with two crucial pieces of information,</span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>encoded as prior probability distributions. The number of socks is a count</span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>variable, so we'll employ a negative binomial data generating process. (We delve</span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>into this topic in more detail in @sec-negative-binomial.) For now, let's follow</span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a>Bååth's lead and set ($\mu = 30$) and (size = 4).</span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r prior_socks}</span></span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe of possible sock counts</span></span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>sock_counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n_socks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probabilities from the negative binomial distribution</span></span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>sock_counts<span class="sc">$</span>probability <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(sock_counts<span class="sc">$</span>n_socks, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the histogram</span></span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sock_counts, <span class="fu">aes</span>(<span class="at">x =</span> n_socks, <span class="at">y =</span> probability)) <span class="sc">+</span></span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total Number of Socks"</span>, <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Prior Distribution for Total Number of Socks"</span>)</span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a>Next, we need to specify our beliefs about the proportion of socks that have a</span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a>pair. For this, we can use a beta data generating process. To remain consistent</span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>with the blog post, we'll set shape1 = 15 and shape2 = 2. This distribution is</span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a>skewed towards higher values, suggesting a belief that most socks in a laundry</span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a>pile are likely to be paired. The parameters indicate an expectation</span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a>around 0.88, reflecting the common experience that unmatched socks are less</span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>frequent.</span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r prior_prop}</span></span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of proportions from 0 to 1</span></span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density values from the beta distribution</span></span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a>density_values <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(proportions, <span class="at">shape1 =</span> <span class="dv">15</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the density plot</span></span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">proportion =</span> proportions, <span class="at">density =</span> density_values),</span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> proportion, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Proportion of Paired Socks"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Prior Distribution for Proportion of Paired Socks"</span>)</span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>These prior distributions encapsulate our initial beliefs before we observe any</span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a>data. The Bayesian approach elegantly allows us to update these beliefs based on</span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a>the evidence, leading to more informed posterior distributions.</span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a>Now, let's craft the R code for simulating draws from this data generating</span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a>process.</span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r simulation, message=FALSE, warning=FALSE}</span></span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable parallel processing with the number of cores available</span></span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="fu">availableCores</span>())</span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of socks picked</span></span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>n_picked <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Improved simulation function</span></span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a>simulate_socks <span class="ot">&lt;-</span> <span class="cf">function</span>(n_picked) {</span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate total number of socks from prior</span></span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a>  n_socks <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate proportion of paired socks from prior</span></span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a>  prop_pairs <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> <span class="dv">15</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate number of pairs and odd socks</span></span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a>  n_pairs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">floor</span>(n_socks <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> prop_pairs)</span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>  n_odd <span class="ot">&lt;-</span> n_socks <span class="sc">-</span> n_pairs <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate picking socks</span></span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>  socks <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_pairs <span class="sc">+</span> n_odd), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="fu">c</span>(n_pairs, n_odd)))</span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a>  picked_socks <span class="ot">&lt;-</span> <span class="fu">sample</span>(socks, <span class="at">size =</span> <span class="fu">min</span>(n_picked, n_socks))</span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a>  sock_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(picked_socks)</span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique =</span> <span class="fu">sum</span>(sock_counts <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairs =</span> <span class="fu">sum</span>(sock_counts <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_socks =</span> n_socks,</span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_pairs =</span> n_pairs,</span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_odd =</span> n_odd,</span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_pairs =</span> prop_pairs</span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simulations</span></span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a>sock_sim <span class="ot">&lt;-</span> <span class="fu">future_map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>n_sims, <span class="sc">~</span><span class="fu">simulate_socks</span>(n_picked),</span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">123</span>))</span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for matching simulations (11 unique socks, 0 pairs)</span></span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a>post_samples <span class="ot">&lt;-</span> sock_sim <span class="sc">%&gt;%</span></span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique <span class="sc">==</span> <span class="dv">11</span>, pairs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>This code implements the ABC method, which is a perfect illustration of the</span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a>"reallocation of credibility across possibilities" that Kruschke and Liddell</span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>describe:</span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We define prior distributions for the total number of socks (negative</span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>    binomial) and the proportion of paired socks (beta). These represent our</span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>    initial beliefs about the possibilities.</span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>We create a generative model that simulates picking socks from a laundry</span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a>    pile.</span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>We run this simulation many times (100,000 in this case), each time</span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a>    generating a possible scenario.</span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>We keep only those simulations that match our observed data (11 unique</span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a>    socks, 0 pairs). This step is where we reallocate credibility, focusing on</span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a>    the possibilities that are consistent with our observation.</span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>We analyze the results by calculating median values from the retained</span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a>    samples, which represent our updated beliefs.</span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing the Results</span></span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r viz}</span></span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting</span></span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a>prior_data <span class="ot">&lt;-</span> sock_sim <span class="sc">%&gt;%</span></span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_socks) <span class="sc">%&gt;%</span></span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"Prior"</span>)</span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a>posterior_data <span class="ot">&lt;-</span> post_samples <span class="sc">%&gt;%</span></span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_socks) <span class="sc">%&gt;%</span></span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"Posterior"</span>)</span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_data, posterior_data)</span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot prior and posterior distributions</span></span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> n_socks, <span class="at">y =</span> prop, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prior"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"Posterior"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior and Posterior Distributions of Total Socks"</span>,</span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Socks"</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Distribution"</span>) <span class="sc">+</span></span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior distribution of pairs and odd socks</span></span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(post_samples, <span class="fu">aes</span>(<span class="at">x =</span> n_pairs, <span class="at">y =</span> n_odd)) <span class="sc">+</span></span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Joint Posterior Distribution of Pairs and Odd Socks"</span>,</span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Pairs"</span>, <span class="at">y =</span> <span class="st">"Number of Odd Socks"</span>) <span class="sc">+</span></span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Interpretation</span></span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a>After running this model, our best guess (median of the posterior) is that Karl</span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a>Broman has approximately:</span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary}</span></span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> post_samples <span class="sc">%&gt;%</span></span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_socks =</span> <span class="fu">median</span>(n_socks),</span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_pairs =</span> <span class="fu">median</span>(n_pairs),</span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_odd =</span> <span class="fu">median</span>(n_odd),</span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower_socks =</span> <span class="fu">quantile</span>(n_socks, <span class="fl">0.025</span>),</span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper_socks =</span> <span class="fu">quantile</span>(n_socks, <span class="fl">0.975</span>)</span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Total socks: <span class="in">`r summary_stats$median_socks`</span></span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a>  (95% CI: <span class="in">`r summary_stats$ci_lower_socks`</span> - <span class="in">`r summary_stats$ci_upper_socks`</span>)</span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Pairs of socks: <span class="in">`r summary_stats$median_pairs`</span></span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Odd socks: <span class="in">`r summary_stats$median_odd`</span></span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a>Remarkably, when Karl later revealed the actual numbers, it turned out there</span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a>were 21 pairs and 3 odd socks, totaling 45 socks. The estimate is surprisingly</span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a>close, considering we only had one piece of information to work with! The</span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a>visualizations provide additional insights:</span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a>The first plot shows how our beliefs about the total number of socks changed</span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a>from the prior (green) to the posterior (blue) distribution after incorporating</span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a>the data. This is a clear visualization of the reallocation of credibility</span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a>across possibilities. The second plot illustrates the joint posterior</span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a>distribution of pairs and odd socks, showing the range of plausible combinations</span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a>given our model and data.</span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a>This example beautifully illustrates several key aspects of Bayesian thinking:</span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Incorporation of prior knowledge: The model uses reasonable priors based on</span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a>    general knowledge about sock ownership.</span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Handling uncertainty: The posterior distribution provides a range of</span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a>    plausible values, not just a point estimate.</span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Learning from limited data: Even with just one piece of information (11</span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a>    unique socks), we can make a surprisingly accurate inference.</span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Flexibility: The ABC approach allows us to work with a complex model that</span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a>    would be difficult to handle with traditional methods.</span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Reallocation of credibility: We start with a wide range of possibilities and</span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a>    narrow down to those most consistent with our observation.</span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a>In business contexts, we often face similar situations - limited data combined</span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a>with domain expertise or prior experience. The sock example, while whimsical,</span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a>demonstrates how Bayesian methods can be powerful in such real-world scenarios.</span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a>As we progress through this book, we'll explore how these principles can be</span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a>applied to more complex business problems.</span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a>As Kruschke and Liddell (2018) point out, one of the key advantages of Bayesian</span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a>analysis is that "the posterior distribution can be directly examined to see</span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a>which parameter values are most credible, and what range of parameter values</span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a>covers the most credible values." This direct interpretation is particularly</span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a>valuable in business settings, where we often need to communicate results to</span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a>non-technical stakeholders.</span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a>For instance, in our sock example, we can straightforwardly say that </span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a>"there's a 95% probability that the total number of socks is between</span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a><span class="in">`r summary_stats$ci_lower_socks`</span> and <span class="in">`r summary_stats$ci_upper_socks`</span>."</span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>This statement is intuitive and directly addresses the uncertainty in our</span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a>estimate, which is crucial for informed decision-making.</span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a>Additionally, we can quantify probabilities for specific scenarios, such as:</span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a>"The probability that there are at least 15 pairs</span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a>is <span class="in">`r scales::percent(mean(post_samples$n_pairs &gt; 14))`</span>."</span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a>Moreover, Bayesian methods naturally handle the "small data" scenarios that are</span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a>common in business. While big data gets a lot of attention, many important</span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a>business decisions are made with limited information. The Bayesian framework</span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a>allows us to start with prior knowledge (perhaps based on industry benchmarks or</span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a>previous experience), update this with whatever data is available, and still</span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a>produce meaningful results.</span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a><span class="fu">### A Note on Priors</span></span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a>It's important to remember that the less data you have, the more influential</span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a>your priors become. Transparency about your priors is essential, as is</span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a>investigating the sensitivity of your findings to different prior choices.</span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a>However, don't shy away from using informative priors when justified by data.</span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a>The interactive dashboard below utilizes {shinylive} (see @shinylive) to run</span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a>these simulations directly in your browser, allowing you to experiment with</span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a>various priors and observe their impact.</span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{shinylive-r}</span></span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| standalone: true</span></span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| viewerHeight: 800</span></span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">shiny</span><span class="kw">)</span></span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">ggplot2</span><span class="kw">)</span></span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">dplyr</span><span class="kw">)</span></span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">furrr</span><span class="kw">)</span></span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">shinybusy</span><span class="kw">)</span></span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">shinydashboard</span><span class="kw">)</span></span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable parallel processing with the number of cores available</span></span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a><span class="ex">plan</span><span class="er">(</span><span class="ex">multisession,</span> workers = availableCores<span class="er">(</span><span class="kw">))</span></span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of socks picked</span></span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a><span class="ex">n_picked</span> <span class="op">&lt;</span>- 11</span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a><span class="ex">simulate_socks</span> <span class="op">&lt;</span>- function<span class="er">(</span><span class="ex">n_picked,</span> mu, size, shape1, shape2<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate total number of socks from prior</span></span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a>  <span class="ex">n_socks</span> <span class="op">&lt;</span>- rnbinom<span class="er">(</span><span class="ex">1,</span> mu = mu, size = size<span class="kw">)</span></span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-516"><a href="#cb8-516" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate proportion of paired socks from prior</span></span>
<span id="cb8-517"><a href="#cb8-517" aria-hidden="true" tabindex="-1"></a>  <span class="ex">prop_pairs</span> <span class="op">&lt;</span>- rbeta<span class="er">(</span><span class="ex">1,</span> shape1 = shape1, shape2 = shape2<span class="kw">)</span></span>
<span id="cb8-518"><a href="#cb8-518" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-519"><a href="#cb8-519" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate number of pairs and odd socks</span></span>
<span id="cb8-520"><a href="#cb8-520" aria-hidden="true" tabindex="-1"></a>  <span class="ex">n_pairs</span> <span class="op">&lt;</span>- round<span class="er">(</span><span class="ex">floor</span><span class="er">(</span><span class="ex">n_socks</span> / 2<span class="kw">)</span> <span class="ex">*</span> prop_pairs<span class="kw">)</span></span>
<span id="cb8-521"><a href="#cb8-521" aria-hidden="true" tabindex="-1"></a>  <span class="ex">n_odd</span> <span class="op">&lt;</span>- n_socks <span class="at">-</span> n_pairs <span class="pp">*</span> 2</span>
<span id="cb8-522"><a href="#cb8-522" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate picking socks</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a>  <span class="ex">socks</span> <span class="op">&lt;</span>- rep<span class="er">(</span><span class="ex">seq_len</span><span class="er">(</span><span class="ex">n_pairs</span> + n_odd<span class="kw">)</span><span class="ex">,</span> rep<span class="er">(</span><span class="ex">c</span><span class="er">(</span><span class="ex">2,</span> 1<span class="kw">)</span><span class="ex">,</span> c<span class="er">(</span><span class="ex">n_pairs,</span> n_odd<span class="kw">)))</span></span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a>  <span class="ex">picked_socks</span> <span class="op">&lt;</span>- sample<span class="er">(</span><span class="ex">socks,</span> size = min<span class="er">(</span><span class="ex">n_picked,</span> n_socks<span class="kw">))</span></span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a>  <span class="ex">sock_counts</span> <span class="op">&lt;</span>- table<span class="er">(</span><span class="ex">picked_socks</span><span class="kw">)</span></span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a>  <span class="ex">tibble</span><span class="er">(</span></span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a>    <span class="ex">unique</span> = sum<span class="er">(</span><span class="ex">sock_counts</span> == 1<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a>    <span class="ex">pairs</span> = sum<span class="er">(</span><span class="ex">sock_counts</span> == 2<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a>    <span class="ex">n_socks</span> = n_socks,</span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a>    <span class="ex">n_pairs</span> = n_pairs,</span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a>    <span class="ex">n_odd</span> = n_odd,</span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a>    <span class="ex">prop_pairs</span> = prop_pairs</span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span></span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a><span class="ex">ui</span> <span class="op">&lt;</span>- dashboardPage<span class="er">(</span></span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a>  <span class="ex">skin</span> = <span class="st">"black"</span>,</span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a>  <span class="ex">dashboardHeader</span><span class="er">(</span><span class="ex">title</span> = <span class="st">"Karl's Socks"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a>  <span class="ex">dashboardSidebar</span><span class="er">(</span></span>
<span id="cb8-543"><a href="#cb8-543" aria-hidden="true" tabindex="-1"></a>    <span class="ex">numericInput</span><span class="er">(</span></span>
<span id="cb8-544"><a href="#cb8-544" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"seed"</span>,</span>
<span id="cb8-545"><a href="#cb8-545" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"Random Seed"</span>,</span>
<span id="cb8-546"><a href="#cb8-546" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 123,</span>
<span id="cb8-547"><a href="#cb8-547" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 1,</span>
<span id="cb8-548"><a href="#cb8-548" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 1</span>
<span id="cb8-549"><a href="#cb8-549" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-550"><a href="#cb8-550" aria-hidden="true" tabindex="-1"></a>    <span class="ex">numericInput</span><span class="er">(</span></span>
<span id="cb8-551"><a href="#cb8-551" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"n_sims"</span>,</span>
<span id="cb8-552"><a href="#cb8-552" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"Number of Simulations"</span>,</span>
<span id="cb8-553"><a href="#cb8-553" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 10000,</span>
<span id="cb8-554"><a href="#cb8-554" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 100,</span>
<span id="cb8-555"><a href="#cb8-555" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 100</span>
<span id="cb8-556"><a href="#cb8-556" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-557"><a href="#cb8-557" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sliderInput</span><span class="er">(</span></span>
<span id="cb8-558"><a href="#cb8-558" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"mu"</span>,</span>
<span id="cb8-559"><a href="#cb8-559" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"mu"</span>,</span>
<span id="cb8-560"><a href="#cb8-560" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 15,</span>
<span id="cb8-561"><a href="#cb8-561" aria-hidden="true" tabindex="-1"></a>      <span class="ex">max</span> = 60,</span>
<span id="cb8-562"><a href="#cb8-562" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 40,</span>
<span id="cb8-563"><a href="#cb8-563" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 1</span>
<span id="cb8-564"><a href="#cb8-564" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-565"><a href="#cb8-565" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sliderInput</span><span class="er">(</span></span>
<span id="cb8-566"><a href="#cb8-566" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"size"</span>,</span>
<span id="cb8-567"><a href="#cb8-567" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"Size"</span>,</span>
<span id="cb8-568"><a href="#cb8-568" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 3,</span>
<span id="cb8-569"><a href="#cb8-569" aria-hidden="true" tabindex="-1"></a>      <span class="ex">max</span> = 10,</span>
<span id="cb8-570"><a href="#cb8-570" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 4,</span>
<span id="cb8-571"><a href="#cb8-571" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 1</span>
<span id="cb8-572"><a href="#cb8-572" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-573"><a href="#cb8-573" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sliderInput</span><span class="er">(</span></span>
<span id="cb8-574"><a href="#cb8-574" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"shape1"</span>,</span>
<span id="cb8-575"><a href="#cb8-575" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"Shape 1"</span>,</span>
<span id="cb8-576"><a href="#cb8-576" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 2,</span>
<span id="cb8-577"><a href="#cb8-577" aria-hidden="true" tabindex="-1"></a>      <span class="ex">max</span> = 20,</span>
<span id="cb8-578"><a href="#cb8-578" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 15,</span>
<span id="cb8-579"><a href="#cb8-579" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 1</span>
<span id="cb8-580"><a href="#cb8-580" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-581"><a href="#cb8-581" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sliderInput</span><span class="er">(</span></span>
<span id="cb8-582"><a href="#cb8-582" aria-hidden="true" tabindex="-1"></a>      <span class="ex">inputId</span> = <span class="st">"shape2"</span>,</span>
<span id="cb8-583"><a href="#cb8-583" aria-hidden="true" tabindex="-1"></a>      <span class="ex">label</span> = <span class="st">"Shape 2"</span>,</span>
<span id="cb8-584"><a href="#cb8-584" aria-hidden="true" tabindex="-1"></a>      <span class="ex">min</span> = 2,</span>
<span id="cb8-585"><a href="#cb8-585" aria-hidden="true" tabindex="-1"></a>      <span class="ex">max</span> = 8,</span>
<span id="cb8-586"><a href="#cb8-586" aria-hidden="true" tabindex="-1"></a>      <span class="ex">value</span> = 2,</span>
<span id="cb8-587"><a href="#cb8-587" aria-hidden="true" tabindex="-1"></a>      <span class="ex">step</span> = 1</span>
<span id="cb8-588"><a href="#cb8-588" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-589"><a href="#cb8-589" aria-hidden="true" tabindex="-1"></a>    <span class="ex">actionButton</span><span class="er">(</span><span class="st">"run_sim"</span><span class="ex">,</span> <span class="st">"Run Simulation"</span><span class="kw">)</span></span>
<span id="cb8-590"><a href="#cb8-590" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-591"><a href="#cb8-591" aria-hidden="true" tabindex="-1"></a>  <span class="ex">dashboardBody</span><span class="er">(</span></span>
<span id="cb8-592"><a href="#cb8-592" aria-hidden="true" tabindex="-1"></a>    <span class="ex">use_busy_spinner</span><span class="er">(</span><span class="ex">spin</span> = <span class="st">"fading-circle"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-593"><a href="#cb8-593" aria-hidden="true" tabindex="-1"></a>    <span class="ex">fluidRow</span><span class="er">(</span></span>
<span id="cb8-594"><a href="#cb8-594" aria-hidden="true" tabindex="-1"></a>      <span class="ex">box</span><span class="er">(</span></span>
<span id="cb8-595"><a href="#cb8-595" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Prior Distribution for Total Number of Socks"</span>, </span>
<span id="cb8-596"><a href="#cb8-596" aria-hidden="true" tabindex="-1"></a>        <span class="ex">status</span> = <span class="st">"danger"</span>, solidHeader = TRUE,</span>
<span id="cb8-597"><a href="#cb8-597" aria-hidden="true" tabindex="-1"></a>        <span class="ex">collapsible</span> = TRUE,</span>
<span id="cb8-598"><a href="#cb8-598" aria-hidden="true" tabindex="-1"></a>        <span class="ex">plotOutput</span><span class="er">(</span><span class="st">"prior_socks"</span><span class="kw">)</span></span>
<span id="cb8-599"><a href="#cb8-599" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-600"><a href="#cb8-600" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-601"><a href="#cb8-601" aria-hidden="true" tabindex="-1"></a>      <span class="ex">box</span><span class="er">(</span></span>
<span id="cb8-602"><a href="#cb8-602" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Prior Distribution for Proportion of Paired Socks"</span>, </span>
<span id="cb8-603"><a href="#cb8-603" aria-hidden="true" tabindex="-1"></a>        <span class="ex">status</span> = <span class="st">"danger"</span>, solidHeader = TRUE,</span>
<span id="cb8-604"><a href="#cb8-604" aria-hidden="true" tabindex="-1"></a>        <span class="ex">collapsible</span> = TRUE,</span>
<span id="cb8-605"><a href="#cb8-605" aria-hidden="true" tabindex="-1"></a>        <span class="ex">plotOutput</span><span class="er">(</span><span class="st">"prior_prop"</span><span class="kw">)</span></span>
<span id="cb8-606"><a href="#cb8-606" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb8-607"><a href="#cb8-607" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-608"><a href="#cb8-608" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-609"><a href="#cb8-609" aria-hidden="true" tabindex="-1"></a>    <span class="ex">fluidRow</span><span class="er">(</span></span>
<span id="cb8-610"><a href="#cb8-610" aria-hidden="true" tabindex="-1"></a>      <span class="ex">box</span><span class="er">(</span></span>
<span id="cb8-611"><a href="#cb8-611" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Prior and Posterior Distributions of Total Socks"</span>, </span>
<span id="cb8-612"><a href="#cb8-612" aria-hidden="true" tabindex="-1"></a>        <span class="ex">status</span> = <span class="st">"danger"</span>, solidHeader = TRUE,</span>
<span id="cb8-613"><a href="#cb8-613" aria-hidden="true" tabindex="-1"></a>        <span class="ex">collapsible</span> = TRUE,</span>
<span id="cb8-614"><a href="#cb8-614" aria-hidden="true" tabindex="-1"></a>        <span class="ex">plotOutput</span><span class="er">(</span><span class="st">"distribution_plot"</span><span class="kw">)</span></span>
<span id="cb8-615"><a href="#cb8-615" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-616"><a href="#cb8-616" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-617"><a href="#cb8-617" aria-hidden="true" tabindex="-1"></a>      <span class="ex">box</span><span class="er">(</span></span>
<span id="cb8-618"><a href="#cb8-618" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Joint Posterior Distribution of Pairs and Odd Socks"</span>, </span>
<span id="cb8-619"><a href="#cb8-619" aria-hidden="true" tabindex="-1"></a>        <span class="ex">status</span> = <span class="st">"danger"</span>, solidHeader = TRUE,</span>
<span id="cb8-620"><a href="#cb8-620" aria-hidden="true" tabindex="-1"></a>        <span class="ex">collapsible</span> = TRUE,</span>
<span id="cb8-621"><a href="#cb8-621" aria-hidden="true" tabindex="-1"></a>        <span class="ex">plotOutput</span><span class="er">(</span><span class="st">"joint_plot"</span><span class="kw">)</span></span>
<span id="cb8-622"><a href="#cb8-622" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb8-623"><a href="#cb8-623" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-624"><a href="#cb8-624" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-625"><a href="#cb8-625" aria-hidden="true" tabindex="-1"></a>    <span class="ex">fluidRow</span><span class="er">(</span></span>
<span id="cb8-626"><a href="#cb8-626" aria-hidden="true" tabindex="-1"></a>      <span class="ex">valueBoxOutput</span><span class="er">(</span><span class="st">"pr_pairs"</span><span class="kw">)</span></span>
<span id="cb8-627"><a href="#cb8-627" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb8-628"><a href="#cb8-628" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span></span>
<span id="cb8-629"><a href="#cb8-629" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb8-630"><a href="#cb8-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-631"><a href="#cb8-631" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> <span class="op">&lt;</span>- function<span class="er">(</span><span class="ex">input,</span> output<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb8-632"><a href="#cb8-632" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a>  <span class="ex">sock_sim</span> <span class="op">&lt;</span>- eventReactive<span class="er">(</span><span class="ex">input</span><span class="va">$run_sim</span><span class="ex">,</span> {</span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a>    <span class="fu">show_modal_spinner()</span>  </span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a>    <span class="ex">on.exit</span><span class="er">(</span><span class="fu">remove_modal_spinner()</span><span class="kw">)</span></span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a>    <span class="ex">set.seed</span><span class="er">(</span><span class="ex">input</span><span class="va">$seed</span><span class="kw">)</span></span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a>    <span class="ex">local_mu</span> <span class="op">&lt;</span>- input<span class="va">$mu</span></span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a>    <span class="ex">local_size</span> <span class="op">&lt;</span>- input<span class="va">$size</span></span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a>    <span class="ex">local_shape1</span> <span class="op">&lt;</span>- input<span class="va">$shape1</span></span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a>    <span class="ex">local_shape2</span> <span class="op">&lt;</span>- input<span class="va">$shape2</span></span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a>    <span class="ex">future_map_dfr</span><span class="er">(</span><span class="ex">1:input</span><span class="va">$n_sims</span><span class="ex">,</span></span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">~simulate_socks</span><span class="er">(</span><span class="ex">n_picked</span> = 11,</span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a>                                   <span class="ex">mu</span> = local_mu,</span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">size</span> = local_size,</span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a>                                   <span class="ex">shape1</span> = local_shape1,</span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a>                                   <span class="ex">shape2</span> = local_shape2<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">.options</span> = furrr_options<span class="er">(</span><span class="ex">seed</span> = 123<span class="kw">))</span></span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a>  <span class="er">}</span><span class="kw">)</span></span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for matching simulations (11 unique socks, 0 pairs)</span></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a>  <span class="ex">post_samples</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sock_sim()</span> <span class="ex">%</span><span class="op">&gt;</span>% </span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a>      <span class="ex">filter</span><span class="er">(</span><span class="ex">unique</span> == 11, pairs == 0<span class="kw">)</span></span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$pr_pairs</span> <span class="op">&lt;</span>- renderValueBox<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">post_samples()</span><span class="kw">)</span></span>
<span id="cb8-658"><a href="#cb8-658" aria-hidden="true" tabindex="-1"></a>    <span class="ex">valueBox</span><span class="er">(</span></span>
<span id="cb8-659"><a href="#cb8-659" aria-hidden="true" tabindex="-1"></a>      <span class="ex">scales::percent</span><span class="er">(</span><span class="ex">mean</span><span class="er">(</span><span class="fu">post_samples()</span><span class="va">$n_pairs</span> <span class="op">&gt;</span> 14<span class="kw">))</span><span class="ex">,</span></span>
<span id="cb8-660"><a href="#cb8-660" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pr[# Pairs &gt; 14]"</span><span class="ex">,</span> icon = icon<span class="er">(</span><span class="st">"socks"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-661"><a href="#cb8-661" aria-hidden="true" tabindex="-1"></a>      <span class="ex">color</span> = <span class="st">"red"</span></span>
<span id="cb8-662"><a href="#cb8-662" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb8-663"><a href="#cb8-663" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-664"><a href="#cb8-664" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-665"><a href="#cb8-665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data for plotting</span></span>
<span id="cb8-666"><a href="#cb8-666" aria-hidden="true" tabindex="-1"></a>  <span class="ex">prior_data</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-667"><a href="#cb8-667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sock_sim()</span> <span class="ex">%</span><span class="op">&gt;</span>%</span>
<span id="cb8-668"><a href="#cb8-668" aria-hidden="true" tabindex="-1"></a>      <span class="ex">count</span><span class="er">(</span><span class="ex">n_socks</span><span class="kw">)</span> <span class="ex">%</span><span class="op">&gt;</span>%</span>
<span id="cb8-669"><a href="#cb8-669" aria-hidden="true" tabindex="-1"></a>      <span class="ex">mutate</span><span class="er">(</span><span class="ex">prop</span> = n / sum<span class="er">(</span><span class="ex">n</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-670"><a href="#cb8-670" aria-hidden="true" tabindex="-1"></a>             <span class="bu">type</span> = <span class="st">"Prior"</span><span class="kw">)</span></span>
<span id="cb8-671"><a href="#cb8-671" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-672"><a href="#cb8-672" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-673"><a href="#cb8-673" aria-hidden="true" tabindex="-1"></a>  <span class="ex">posterior_data</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-674"><a href="#cb8-674" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="kw">(</span><span class="ex">nrow</span><span class="er">(</span><span class="fu">post_samples()</span><span class="kw">)</span> <span class="ex">==</span> 0<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb8-675"><a href="#cb8-675" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="kw">(</span><span class="ex">tibble</span><span class="er">(</span><span class="ex">n_socks</span> = numeric<span class="er">(</span><span class="kw">)</span><span class="ex">,</span> prop = numeric<span class="er">(</span><span class="kw">)</span><span class="ex">,</span> type = character<span class="er">(</span><span class="kw">)))</span> </span>
<span id="cb8-676"><a href="#cb8-676" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb8-677"><a href="#cb8-677" aria-hidden="true" tabindex="-1"></a>    <span class="fu">post_samples()</span> <span class="ex">%</span><span class="op">&gt;</span>%</span>
<span id="cb8-678"><a href="#cb8-678" aria-hidden="true" tabindex="-1"></a>      <span class="ex">count</span><span class="er">(</span><span class="ex">n_socks</span><span class="kw">)</span> <span class="ex">%</span><span class="op">&gt;</span>%</span>
<span id="cb8-679"><a href="#cb8-679" aria-hidden="true" tabindex="-1"></a>      <span class="ex">mutate</span><span class="er">(</span><span class="ex">prop</span> = n / sum<span class="er">(</span><span class="ex">n</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-680"><a href="#cb8-680" aria-hidden="true" tabindex="-1"></a>             <span class="bu">type</span> = <span class="st">"Posterior"</span><span class="kw">)</span></span>
<span id="cb8-681"><a href="#cb8-681" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-682"><a href="#cb8-682" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-683"><a href="#cb8-683" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$prior_socks</span> <span class="op">&lt;</span>- renderPlot<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-684"><a href="#cb8-684" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dataframe of possible sock counts</span></span>
<span id="cb8-685"><a href="#cb8-685" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sock_counts</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span><span class="ex">n_socks</span> = 0:100<span class="kw">)</span></span>
<span id="cb8-686"><a href="#cb8-686" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-687"><a href="#cb8-687" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate probabilities from the negative binomial distribution</span></span>
<span id="cb8-688"><a href="#cb8-688" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sock_counts</span><span class="va">$probability</span> <span class="op">&lt;</span>- dnbinom<span class="er">(</span><span class="ex">sock_counts</span><span class="va">$n_socks</span><span class="ex">,</span></span>
<span id="cb8-689"><a href="#cb8-689" aria-hidden="true" tabindex="-1"></a>                                       <span class="ex">mu</span> = input<span class="va">$mu</span>,</span>
<span id="cb8-690"><a href="#cb8-690" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">size</span> = input<span class="va">$size</span><span class="kw">)</span></span>
<span id="cb8-691"><a href="#cb8-691" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-692"><a href="#cb8-692" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the histogram</span></span>
<span id="cb8-693"><a href="#cb8-693" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ggplot</span><span class="er">(</span><span class="ex">sock_counts,</span> aes<span class="er">(</span><span class="ex">x</span> = n_socks, y = probability<span class="kw">))</span> <span class="ex">+</span></span>
<span id="cb8-694"><a href="#cb8-694" aria-hidden="true" tabindex="-1"></a>      <span class="ex">geom_col</span><span class="er">(</span><span class="ex">fill</span> = <span class="st">"skyblue"</span>, color = <span class="st">"black"</span><span class="kw">)</span><span class="ex">+</span> </span>
<span id="cb8-695"><a href="#cb8-695" aria-hidden="true" tabindex="-1"></a>      <span class="ex">scale_y_continuous</span><span class="er">(</span><span class="ex">labels</span> = scales::percent<span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-696"><a href="#cb8-696" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal()</span> <span class="ex">+</span></span>
<span id="cb8-697"><a href="#cb8-697" aria-hidden="true" tabindex="-1"></a>      <span class="ex">labs</span><span class="er">(</span><span class="ex">x</span> = <span class="st">"Total Number of Socks"</span>, y = <span class="st">"Probability"</span><span class="kw">)</span></span>
<span id="cb8-698"><a href="#cb8-698" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-699"><a href="#cb8-699" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-700"><a href="#cb8-700" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$prior_prop</span> <span class="op">&lt;</span>- renderPlot<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-701"><a href="#cb8-701" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a sequence of proportions from 0 to 1</span></span>
<span id="cb8-702"><a href="#cb8-702" aria-hidden="true" tabindex="-1"></a>    <span class="ex">proportions</span> <span class="op">&lt;</span>- seq<span class="er">(</span><span class="ex">0,</span> 1, length.out = 100<span class="kw">)</span></span>
<span id="cb8-703"><a href="#cb8-703" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-704"><a href="#cb8-704" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate density values from the beta distribution</span></span>
<span id="cb8-705"><a href="#cb8-705" aria-hidden="true" tabindex="-1"></a>    <span class="ex">density_values</span> <span class="op">&lt;</span>- dbeta<span class="er">(</span><span class="ex">proportions,</span> shape1 = input<span class="va">$shape1</span>,</span>
<span id="cb8-706"><a href="#cb8-706" aria-hidden="true" tabindex="-1"></a>                            <span class="ex">shape2</span> = input<span class="va">$shape2</span><span class="kw">)</span></span>
<span id="cb8-707"><a href="#cb8-707" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-708"><a href="#cb8-708" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the density plot</span></span>
<span id="cb8-709"><a href="#cb8-709" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ggplot</span><span class="er">(</span><span class="ex">data.frame</span><span class="er">(</span><span class="ex">proportion</span> = proportions, density = density_values<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb8-710"><a href="#cb8-710" aria-hidden="true" tabindex="-1"></a>           <span class="ex">aes</span><span class="er">(</span><span class="ex">x</span> = proportion, y = density<span class="kw">))</span> <span class="ex">+</span></span>
<span id="cb8-711"><a href="#cb8-711" aria-hidden="true" tabindex="-1"></a>      <span class="ex">geom_line</span><span class="er">(</span><span class="ex">color</span> = <span class="st">"darkgreen"</span><span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-712"><a href="#cb8-712" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal()</span> <span class="ex">+</span></span>
<span id="cb8-713"><a href="#cb8-713" aria-hidden="true" tabindex="-1"></a>      <span class="ex">labs</span><span class="er">(</span><span class="ex">x</span> = <span class="st">"Proportion of Paired Socks"</span>, y = <span class="st">"Density"</span><span class="kw">)</span></span>
<span id="cb8-714"><a href="#cb8-714" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-715"><a href="#cb8-715" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-716"><a href="#cb8-716" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$distribution_plot</span> <span class="op">&lt;</span>- renderPlot<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-717"><a href="#cb8-717" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">prior_data()</span><span class="ex">,</span> posterior_data<span class="er">(</span><span class="kw">))</span></span>
<span id="cb8-718"><a href="#cb8-718" aria-hidden="true" tabindex="-1"></a>    <span class="ex">plot_data</span> <span class="op">&lt;</span>- bind_rows<span class="er">(</span><span class="fu">prior_data()</span><span class="ex">,</span> posterior_data<span class="er">(</span><span class="kw">))</span></span>
<span id="cb8-719"><a href="#cb8-719" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-720"><a href="#cb8-720" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ggplot</span><span class="er">(</span><span class="ex">plot_data,</span> aes<span class="er">(</span><span class="ex">x</span> = n_socks, y = prop, fill = type<span class="kw">))</span> <span class="ex">+</span></span>
<span id="cb8-721"><a href="#cb8-721" aria-hidden="true" tabindex="-1"></a>      <span class="ex">geom_col</span><span class="er">(</span><span class="ex">position</span> = <span class="st">"dodge"</span>, alpha = 0.7<span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-722"><a href="#cb8-722" aria-hidden="true" tabindex="-1"></a>      <span class="ex">scale_fill_manual</span><span class="er">(</span><span class="ex">values</span> = c<span class="er">(</span><span class="st">"Prior"</span> = <span class="st">"lightgreen"</span>, <span class="st">"Posterior"</span> = <span class="st">"skyblue"</span><span class="kw">))</span> <span class="ex">+</span></span>
<span id="cb8-723"><a href="#cb8-723" aria-hidden="true" tabindex="-1"></a>      <span class="ex">scale_y_continuous</span><span class="er">(</span><span class="ex">labels</span> = scales::percent<span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-724"><a href="#cb8-724" aria-hidden="true" tabindex="-1"></a>      <span class="ex">labs</span><span class="er">(</span><span class="ex">x</span> = <span class="st">"Number of Socks"</span>, y = <span class="st">"Probability"</span>, fill = <span class="st">"Distribution"</span><span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-725"><a href="#cb8-725" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal()</span> <span class="ex">+</span></span>
<span id="cb8-726"><a href="#cb8-726" aria-hidden="true" tabindex="-1"></a>      <span class="ex">theme</span><span class="er">(</span><span class="ex">legend.position</span> = <span class="st">"top"</span><span class="kw">)</span></span>
<span id="cb8-727"><a href="#cb8-727" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-728"><a href="#cb8-728" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-729"><a href="#cb8-729" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$joint_plot</span> <span class="op">&lt;</span>- renderPlot<span class="er">(</span><span class="kw">{</span></span>
<span id="cb8-730"><a href="#cb8-730" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">post_samples()</span><span class="kw">)</span></span>
<span id="cb8-731"><a href="#cb8-731" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="kw">(</span><span class="ex">nrow</span><span class="er">(</span><span class="fu">post_samples()</span><span class="kw">)</span> <span class="op">&gt;</span> 0<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb8-732"><a href="#cb8-732" aria-hidden="true" tabindex="-1"></a>      <span class="ex">ggplot</span><span class="er">(</span><span class="fu">post_samples()</span><span class="ex">,</span> aes<span class="er">(</span><span class="ex">x</span> = n_pairs, y = n_odd<span class="kw">))</span> <span class="ex">+</span></span>
<span id="cb8-733"><a href="#cb8-733" aria-hidden="true" tabindex="-1"></a>        <span class="ex">geom_hex</span><span class="er">(</span><span class="ex">bins</span> = 30<span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-734"><a href="#cb8-734" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_viridis_c()</span> <span class="ex">+</span></span>
<span id="cb8-735"><a href="#cb8-735" aria-hidden="true" tabindex="-1"></a>        <span class="ex">labs</span><span class="er">(</span><span class="ex">x</span> = <span class="st">"Number of Pairs"</span>, y = <span class="st">"Number of Odd Socks"</span><span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-736"><a href="#cb8-736" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal()</span></span>
<span id="cb8-737"><a href="#cb8-737" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span> <span class="cf">else</span> <span class="kw">{</span></span>
<span id="cb8-738"><a href="#cb8-738" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot()</span> <span class="ex">+</span> </span>
<span id="cb8-739"><a href="#cb8-739" aria-hidden="true" tabindex="-1"></a>        <span class="ex">annotate</span><span class="er">(</span><span class="st">"text"</span><span class="ex">,</span> x = 0.5, y = 0.5, label = <span class="st">"No matching simulations found"</span><span class="kw">)</span> <span class="ex">+</span></span>
<span id="cb8-740"><a href="#cb8-740" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_void()</span></span>
<span id="cb8-741"><a href="#cb8-741" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb8-742"><a href="#cb8-742" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb8-743"><a href="#cb8-743" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb8-744"><a href="#cb8-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-745"><a href="#cb8-745" aria-hidden="true" tabindex="-1"></a><span class="ex">shinyApp</span><span class="er">(</span><span class="ex">ui,</span> server<span class="kw">)</span></span>
<span id="cb8-746"><a href="#cb8-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-747"><a href="#cb8-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-748"><a href="#cb8-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-749"><a href="#cb8-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-750"><a href="#cb8-750" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb8-751"><a href="#cb8-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-752"><a href="#cb8-752" aria-hidden="true" tabindex="-1"></a>Bayesian statistics offers a powerful and intuitive framework for business data</span>
<span id="cb8-753"><a href="#cb8-753" aria-hidden="true" tabindex="-1"></a>science, aligning closely with how businesses make decisions. By incorporating</span>
<span id="cb8-754"><a href="#cb8-754" aria-hidden="true" tabindex="-1"></a>prior knowledge, we can update our beliefs based on evidence and quantify</span>
<span id="cb8-755"><a href="#cb8-755" aria-hidden="true" tabindex="-1"></a>uncertainty in a natural way. The concept of reallocating credibility across</span>
<span id="cb8-756"><a href="#cb8-756" aria-hidden="true" tabindex="-1"></a>possibilities provides an intuitive way to think about learning from data.</span>
<span id="cb8-757"><a href="#cb8-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-758"><a href="#cb8-758" aria-hidden="true" tabindex="-1"></a>Furthermore, Bayesian methods are particularly well-suited to the "small data"</span>
<span id="cb8-759"><a href="#cb8-759" aria-hidden="true" tabindex="-1"></a>scenarios often encountered in business. While "big data" garners much</span>
<span id="cb8-760"><a href="#cb8-760" aria-hidden="true" tabindex="-1"></a>attention, many crucial business decisions hinge on limited information. The</span>
<span id="cb8-761"><a href="#cb8-761" aria-hidden="true" tabindex="-1"></a>Bayesian framework allows us to begin with prior knowledge, update it with</span>
<span id="cb8-762"><a href="#cb8-762" aria-hidden="true" tabindex="-1"></a>available data, and then communicate our findings in plain language.</span>
<span id="cb8-763"><a href="#cb8-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-764"><a href="#cb8-764" aria-hidden="true" tabindex="-1"></a>In essence, Bayesian statistics provides a flexible and powerful approach for</span>
<span id="cb8-765"><a href="#cb8-765" aria-hidden="true" tabindex="-1"></a>tackling the complex and often uncertain world of business decision-making.</span>
<span id="cb8-766"><a href="#cb8-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-767"><a href="#cb8-767" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb8-768"><a href="#cb8-768" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learn more</span></span>
<span id="cb8-769"><a href="#cb8-769" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@kruschke2018bayesian Bayesian data analysis for newcomers.</span>
<span id="cb8-770"><a href="#cb8-770" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@mcelreath2018statistical Statistical Rethinking: A Bayesian Course with</span>
<span id="cb8-771"><a href="#cb8-771" aria-hidden="true" tabindex="-1"></a>    Examples in R and Stan</span>
<span id="cb8-772"><a href="#cb8-772" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@gelman2013bayesian Bayesian Data Analysis.</span>
<span id="cb8-773"><a href="#cb8-773" aria-hidden="true" tabindex="-1"></a>::: </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ignacio82/book/edit/master/bayes101.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><div class="page-columns page-rows-contents page-layout-article"><div class="social-share"><a href="https://www.linkedin.com/shareArticle?url=https://book.martinez.fyi/&amp;title=Business Data Science" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a>  <a href="mailto:?subject=Business Data Science&amp;body=Check out this link:https://book.martinez.fyi/" target="_blank" class="email"><i class="fa-solid fa-envelope fa-fw fa-lg"></i></a><a href="javascript:void(0);" onclick="var mastodon_instance=prompt('Mastodon Instance / Server Name?'); if(typeof mastodon_instance==='string' &amp;&amp; mastodon_instance.length){this.href='https://'+mastodon_instance+'/share?text=Business Data Science https://book.martinez.fyi/'}else{return false;}" target="_blank" class="mastodon"><i class="fa-brands fa-mastodon fa-fw fa-lg"></i></a></div></div>




</body></html>